<?xml version="1.0" encoding="utf-8"?>
<EDV>
    <Version Major="1" Minor="0" Build="0" Revision="131">1.0.0.131</Version>
    <DOM ShortName="{Applications}">
        <DOM ShortName="CoopEShop">
            <!--.{Applications}.CoopEShop.Admin-->
            <VAR ShortName="Admin" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Domain">
                <!--.{Applications}.CoopEShop.Admin.edvAppli-->
                <VAR ShortName="edvAppli" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean" SaveLocation="V">
                    <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                </VAR>
                <!--.{Applications}.CoopEShop.Admin.edvStats-->
                <VAR ShortName="edvStats" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                    <Value><![CDATA[CoopEShop]]></Value>
                </VAR>
                <DOM ShortName="edvAppli">
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.ApplicationId-->
                    <VAR ShortName="ApplicationId" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                        <Script><![CDATA[.EDV.CoopEShop.edvAppli.ApplicationId + ".Admin"]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Data-->
                    <VAR ShortName="Data" ClassName="VarDataTable" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DataTable">
                        <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="XML"><xs:complexType><xs:sequence><xs:element name="IdParam" msdata:Caption="" type="xs:string" /><xs:element name="Value" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Visual" msdata:Caption="" type="xs:boolean" minOccurs="0" /><xs:element name="Title" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="UserLevel" msdata:Caption="" type="xs:int" minOccurs="0" /><xs:element name="Category" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="SortIndex" msdata:Caption="" type="xs:double" minOccurs="0" /><xs:element name="Unit" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Error" msdata:Caption="" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="XML" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element ref="XML" /></xs:choice></xs:complexType><xs:unique name="Constraint1" msdata:PrimaryKey="true"><xs:selector xpath=".//XML" /><xs:field xpath="IdParam" /></xs:unique></xs:element></xs:schema></Schema><Data /></DataTable>]]></Value>
                        <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource-->
                    <VAR ShortName="DataSource" ClassName="VarDataSource" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Text">
                        <Script><![CDATA[.EDV.CoopEShop.edvAppli.DataSource]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVClient-->
                    <VAR ShortName="EDVClient" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual-->
                    <VAR ShortName="EDVVisual" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File">
                        <Script><![CDATA[.{Sys}.Path.Bin + "\\EDVVisual.exe"]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Errors-->
                    <VAR ShortName="Errors" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Text" SaveLocation="V" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.jsc-->
                    <VAR ShortName="jsc" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean">
                        <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Log-->
                    <VAR ShortName="Log" ClassName="VarLog" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" SaveLocation="V" Control="EDVCtrlLog" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Midnight-->
                    <VAR ShortName="Midnight" ClassName="EDVDelay@EDVFunctions" AutoReset="1" Securized="1" ReadOnly="1" ValueType="Boolean" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.OnLoad-->
                    <VAR ShortName="OnLoad" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                        <Script><![CDATA[when(..:Checking && ..){//edvAppli passe à true lors du chargement du fichier edvars du fait de l'existance d'un script OnLoad
	edvInfo = "Chargement de " + ..:Domain;
	if(Save.Local.Exists)
		edvClient.OpenVarsFile(Save.Local, ".");
	Data.Open;

	:Done = true;
}
null;]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Save-->
                    <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Session-->
                    <VAR ShortName="Session" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Boolean">
                        <Script><![CDATA[edvSender.NameUpper.StartsWith(".{CLIENTS}.")]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Title-->
                    <VAR ShortName="Title" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                        <Script><![CDATA["Administrateur de " + .EDV.CoopEShop.edvAppli.Title]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Update-->
                    <VAR ShortName="Update" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Url-->
                    <VAR ShortName="Url" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                        <Script><![CDATA[..:Domain + "edv"
/*
var path = edvTools.Domain(edvTools.ParentName(edvSender.Name)) + "Visual.";
var appli = ..ApplicationId;
var isSession = path.StartsWith(".{CLIENTS}");
if(isSession)
	"/edv/" + appli + "/" + path.Substring(path.IndexOf(".",12)) + "edvsess";
else
	"/edv/" + appli + "/" + path + "edvmaster";
*/]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User-->
                    <VAR ShortName="User" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object" SaveLocation="V" />
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Version-->
                    <VAR ShortName="Version" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                        <Script><![CDATA[:Major + "." + :Minor + "." + :Build + "." + :Revision]]></Script>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual-->
                    <VAR ShortName="Visual" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual">
                        <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                    </VAR>
                    <DOM ShortName="Data">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Model-->
                        <VAR ShortName="Model" ClassName="VarDataTable" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DataTable">
                            <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="Internal" msdata:CaseSensitive="False"><xs:complexType><xs:sequence><xs:element name="IdParam" msdata:Caption="" type="xs:string" /><xs:element name="Value" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Visual" msdata:Caption="" type="xs:boolean" minOccurs="0" /><xs:element name="Title" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="UserLevel" msdata:Caption="" type="xs:int" minOccurs="0" /><xs:element name="Category" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="SortIndex" type="xs:int" minOccurs="0" /><xs:element name="Unit" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Error" msdata:Caption="" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="Internal" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element ref="Internal" /></xs:choice></xs:complexType><xs:unique name="Constraint1" msdata:PrimaryKey="true"><xs:selector xpath=".//Internal" /><xs:field xpath="IdParam" /></xs:unique></xs:element></xs:schema></Schema><Data><DocumentElement /></Data></DataTable>]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Open-->
                        <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Save-->
                        <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Source-->
                        <VAR ShortName="Source" ClassName="VarDataSource" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Text">
                            <Script><![CDATA["Provider=XML;Data Source=" + :DBName;]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Validate-->
                        <VAR ShortName="Validate" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        <DOM ShortName="Model">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Model.Save-->
                            <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Model.Save.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..)
{
	var varRef = ..edvAppli:Object;
	var domain = varRef.Domain.ToUpper();
	var lModelTable = ...;
	var variables = edvClient.GetVariables(..edvAppli:Domain);
	lModelTable.CaseSensitive = false;
	for(var lVar in variables.Values)
		if (EDV.SaveLocation.ContainsLocation(lVar.SaveLocation, EDV.SaveLocation.Application)
		//&& (edvInfo = domain + " / " + lVar.Name + " / " + relName) != ""
		){
			var relName = edvTools.GetRelativeName(varRef.Name, lVar.Name);
			if(lModelTable.Select("IdParam = '" + lVar.Name + "'"
				+ " OR IdParam = '" + relName.ToUpper() + "'"
				).Length == 0) {
					//edvInfo = "	add " + typeof(relName);
					var newRow = lModelTable.NewRow();
					newRow[0] = relName;
					newRow[1] = lVar.ValueType == EDVType.Password ? "" : lVar.Value;
					newRow["SortIndex"] = 9999;
					lModelTable.Rows.Add(newRow);
				}
		}
/*	var lVarRoot = ..edvAppli:Parent;
	var lModelTable = ...;

	for(var lVar in edvClient.GetVariables(..edvAppli:Domain).Values)
		if (EDV.SaveLocation.ContainsLocation(lVar.SaveLocation, EDV.SaveLocation.Application)
		&& lModelTable.Select("IdParam = '" + lVar.Name + "'"
			+ " OR IdParam = '" + lVar.Name.Substring(lVarRoot.Name.Length+1) + "'").Length == 0) {
				var newRow = lModelTable.NewRow();
				newRow[0] = lVar.Name.Substring(lVarRoot.Name.Length+1);
				newRow[1] = lVar.Value;
				newRow["SortIndex"] = 999;
				lModelTable.Rows.Add(newRow);

		}*/

	var rows = lModelTable.Select("", "SortIndex");
	lModelTable = lModelTable.Clone();
	for(var row in rows.GetEnumerator()){
		var newRow = lModelTable.NewRow();
		newRow.ItemArray = row.ItemArray;
		lModelTable.Rows.Add(newRow);
	}
	... = lModelTable;
}
]]></Script>
                                </VAR>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Open">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Open.OnChanged-->
                            <VAR ShortName="OnChanged" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changed) {
	edvInfo = :Name + " : Chargement des paramètres généraux.";
	var dataTable = ...;
	var lVarRoot =..edvAppli:Parent;
	if (lVarRoot != null){
		for(var lRow : DataRow in dataTable.Select("", "SortIndex").GetEnumerator()) {
			var lVarName = lRow["IdParam"];
			var lVar = null;

			if(lVarName.StartsWith(":"))
				lVar = lVarRoot["edvAppli." + lVarName.Substring(1)];
			else
				lVar = lVarRoot[lVarName];
			if (lVar != null){
				if(!lRow.IsNull("Value"))
					lVar.Value = lRow["Value"];
				lRow["Error"] = DBNull.Value;
			}
			else {
				edvInfo = :Name + " : la donnée sauvegardée '" + lVarName + "' ne correspond à aucune variable.";
				lRow["Error"] = "introuvable";
			}
		}
	}
}
null;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Open.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changing){
	var dataTable = ...;
	if (!dataTable.Columns.Contains("SortIndex"))
		dataTable.Columns.Add("SortIndex", Int32);
	if (!dataTable.Columns.Contains("Unit"))
		dataTable.Columns.Add("Unit", String);
	if (!dataTable.Columns.Contains("Error"))
		dataTable.Columns.Add("Error", String);

	var modelTable = ..Model;
	var rows;
	for(var modelRow in modelTable.Rows) {
		if((rows = dataTable.Select("IdParam='" + modelRow["IdParam"] + "'")).Length==0) {
			var newRow = dataTable.NewRow();
			for(var column in dataTable.Columns)
				newRow[column] = modelRow[column.ColumnName];
			dataTable.Rows.Add(newRow);
		}
		else {
			rows[0]["Visual"] = modelRow["Visual"];
			rows[0]["Title"] = modelRow["Title"];
			rows[0]["UserLevel"] = modelRow["UserLevel"];
			rows[0]["Category"] = modelRow["Category"];
			rows[0]["SortIndex"] = modelRow["SortIndex"];
			rows[0]["Unit"] = modelRow["Unit"];
		}
	}

	/*//set sorted table
	var rows = dataTable.Select("", "SortIndex");
	dataTable = dataTable.Clone();
	for(var row in rows.GetEnumerator()){
		var newRow = dataTable.NewRow();
		newRow.ItemArray = row.ItemArray;
		dataTable.Rows.Add(newRow);
	}
	... = dataTable;
	*/
}
null;
]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Open.OnChecking-->
                            <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Checking)
	if(..Source.DBName == ""){
		.. = false;
	}
null;]]></Script>
                            </VAR>
                            <DOM ShortName="OnChanged">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Open.OnChanged._Script-->
                                <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[when(..:Changed) {
	edvInfo = :Name + " : Chargement des paramètres généraux.";
	var dataTable = ...;
	var lVarRoot =..edvAppli:Parent;
	if (lVarRoot != null){
		for(var lRow : DataRow in dataTable.Select("", "SortIndex").GetEnumerator()) {
			var lVarName = lRow["IdParam"];
			var lVar = null;

			if(lVarName.StartsWith(":"))
				lVar = lVarRoot["edvAppli." + lVarName.Substring(1)];
			else
				lVar = lVarRoot[lVarName];
			if (lVar != null){
				if(!lRow.IsNull("Value"))
					lVar.Value = lRow["Value"];
				lRow["Error"] = DBNull.Value;
			}
			else {
				edvInfo = :Name + " : la donnée sauvegardée '" + lVarName + "' ne correspond à aucune variable.";
				lRow["Error"] = "introuvable";
			}
		}
	}
}
null;]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="Save">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Save.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..){
	edvInfo = :Name + " : Enregistrement des paramètres généraux";
	var lVarRoot, lVar;
	if ((lVarRoot = ..edvAppli:Parent) != null) {
		var lDataTable = ...;
		for(var lRow in lDataTable.Rows) {
			if(lRow["IdParam"].StartsWith(":"))
				lVar = lVarRoot["edvAppli." + lRow["IdParam"].Substring(1)];
			else
				lVar = lVarRoot[lRow["IdParam"]];
			if (lVar != null){
				lRow["Value"] = lVar.Value;
				lRow["Error"] = DBNull.Value;
			}
			else {
				edvError = :Name + "\t\t\tLe paramètre " + lRow["IdParam"] + " n'existe pas en référence à " + lVarRoot.Name;
				lRow["Error"] = "introuvable";
			}
		}
		..Validate;
	}
}
]]></Script>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Source">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Source.DBName-->
                            <VAR ShortName="DBName" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                                <Script><![CDATA[var lsFile = ..Save.File;//Fichier .edvars d'où est chargé l'application
if (lsFile != "" && !lsFile.StartsWith("\t\t\tATTENTION")) lsFile.substring(0, lsFile.length-".edvars".length) + ".Params.xml";
else "";]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Source.DBPassword-->
                            <VAR ShortName="DBPassword" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Password" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Source.DBServer-->
                            <VAR ShortName="DBServer" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Source.DBType-->
                            <VAR ShortName="DBType" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[XML]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Data.Source.DBUser-->
                            <VAR ShortName="DBUser" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                        </DOM>
                    </DOM>
                    <DOM ShortName="DataSource">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBName-->
                        <VAR ShortName="DBName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBPassword-->
                        <VAR ShortName="DBPassword" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Password" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBServer-->
                        <VAR ShortName="DBServer" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBType-->
                        <VAR ShortName="DBType" ClassName="VarSelection" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Selection">
                            <Value><![CDATA[Internal]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBUser-->
                        <VAR ShortName="DBUser" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                        <DOM ShortName="DBType">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBType.InsertAuto-->
                            <VAR ShortName="InsertAuto" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[False]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBType.InValues-->
                            <VAR ShortName="InValues" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[True]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.DataSource.DBType.Values-->
                            <VAR ShortName="Values" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Text">
                                <Value><![CDATA[Internal
EDV
EDVServer
XML
Oracle
SQLServer
Access
TextFile
MySQL
Excel
FileSystem
FTP]]></Value>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="EDVVisual">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer-->
                        <VAR ShortName="_Designer" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments-->
                        <VAR ShortName="Arguments" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<?
if(:Address != "") 			echo("Address:=" + :Address + " ");
if(:Port != 0) 				echo("Port:=" + :Port + " ");
if(:Open.Always && :Open != "") 	echo("OpenIf:=Always ");
else					echo("OpenIf:=NotExists ");
if(:Open != "") 			echo("Open:=" + :Open + " ");
if(:OpenInSession >= 0) 		echo("OpenInSession:=" + :OpenInSession + " ");
if(:Close) 				echo("Close:=1" + " ");
if(:Url != "") 				echo("Url:=" + :Url + " ");
if(:Var != "") 				echo("Var:=" + :Var + " ");
if(:Visual != "") 			echo("Visual:=" + :Visual + " ");
?>]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.CreateDesktopShortCut-->
                        <VAR ShortName="CreateDesktopShortCut" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Open-->
                        <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        <DOM ShortName="_Designer">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN-->
                            <VAR ShortName="WIN" ClassName="WinForm@EDVVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[False]]></Value>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.Height-->
                                <VAR ShortName="Height" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[115]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.Text-->
                                <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[Name]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.TextAuto-->
                                <VAR ShortName="TextAuto" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.Width-->
                                <VAR ShortName="Width" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[303]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.WindowStartPosition-->
                                <VAR ShortName="WindowStartPosition" ClassName="FormStartPosition@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                    <Value><![CDATA[Manual]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.WindowState-->
                                <VAR ShortName="WindowState" ClassName="FormWindowState@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                    <Value><![CDATA[Normal]]></Value>
                                </VAR>
                                <DOM ShortName="ctrlAlways">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlAlways.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[Arguments.Open.Always]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlAlways._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlVar]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlAlways.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=31,Y=44,Width=60,Height=16}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlCreateDesktopShortCut">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlCreateDesktopShortCut.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[CreateDesktopShortCut]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlCreateDesktopShortCut._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlVar]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlCreateDesktopShortCut.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=115,Y=70,Width=141,Height=16}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlEDVVisual">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlEDVVisual.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[..EDVVisual]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlEDVVisual._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlVar]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlEDVVisual.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=3,Y=2,Width=75,Height=16}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlOpen">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlOpen.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[Arguments.Open]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlOpen._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlVar]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlOpen.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=19,Y=24,Width=283,Height=16}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlOpen1">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlOpen1.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[Open]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlOpen1._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlVar]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlOpen1.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=15,Y=98,Width=49,Height=16}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlShortCutName">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[CreateDesktopShortCut.ShortCutName]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlText]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=189,Y=90,Width=100,Height=13}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlShortCutName1">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName1.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[CreateDesktopShortCut.ShortCutName]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName1._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlVar]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName1.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=129,Y=90,Width=54,Height=14}]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ctrlSub">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlSub.@-->
                                    <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[Arguments.Visual.Sub]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlSub._ClassName-->
                                    <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[EDVCtrlText]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual._Designer.WIN.ctrlSub.Bounds-->
                                    <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[{X=17,Y=68,Width=50,Height=20}]]></Value>
                                    </VAR>
                                </DOM>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Arguments">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Address-->
                            <VAR ShortName="Address" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Close-->
                            <VAR ShortName="Close" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[False]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Open-->
                            <VAR ShortName="Open" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File">
                                <Script><![CDATA[..edvAppli.Save.File]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.OpenInSession-->
                            <VAR ShortName="OpenInSession" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                <Value><![CDATA[-1]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>HTML</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Port-->
                            <VAR ShortName="Port" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                <Value><![CDATA[0]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Url-->
                            <VAR ShortName="Url" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Var-->
                            <VAR ShortName="Var" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Visual-->
                            <VAR ShortName="Visual" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="VariableName">
                                <Script><![CDATA[..edvAppli:Domain + :Sub]]></Script>
                            </VAR>
                            <DOM ShortName="Open">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Open.Always-->
                                <VAR ShortName="Always" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Visual">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.Arguments.Visual.Sub-->
                                <VAR ShortName="Sub" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                    <Value><![CDATA[Visual]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="CreateDesktopShortCut">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.CreateDesktopShortCut.AllUsers-->
                            <VAR ShortName="AllUsers" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[True]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.CreateDesktopShortCut.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changing)
{
	var exeFile = ...;
	var linkName : String = ShortCutName;

	var Shell = new ActiveXObject("WScript.Shell");
	var DesktopPath = Shell.SpecialFolders(AllUsers ? "AllUsersDesktop" : "Desktop");
	var link = Shell.CreateShortcut(DesktopPath + "\\"+  linkName + ".lnk");
	link.Arguments = edvcode(..Arguments:Name);
	link.Description = "";
	//link.HotKey = "CTRL+ALT+SHIFT+X";
	link.IconLocation = exeFile + ", 0";
	link.TargetPath = exeFile;
	link.WindowStyle = 1;
	link.WorkingDirectory = Path.GetDirectoryName(exeFile);
	link.Save();

}
null;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.EDVVisual.CreateDesktopShortCut.ShortCutName-->
                            <VAR ShortName="ShortCutName" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                                <Script><![CDATA[..edvAppli.Title]]></Script>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Errors">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Errors.Check-->
                        <VAR ShortName="Check" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean">
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Errors.Check.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changing
&& !edvSender.NameUpper.StartsWith(DOM.MODELS.ToUpper())) {
	var step;
	try {
		step = "Création du dataSource pour la source de données";
		var cx = edv.Data(..DataSource);

		step = "Connexion à la source de données";
		cx.connection();

		cx.close();
	}
	catch(ex){
		edvError = :Name + (... = step + " : " + ex);
	}
}
null;]]></Script>
                            </VAR>
                        </VAR>
                    </DOM>
                    <DOM ShortName="Html">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Html.Head-->
                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<script>
	edv.Appli.Enabled = true;
</script>
<?if (..User.NeedLogin 
  && (..User == null || !..User.Login)){
	echo(..User.Login.Visual.HTML);
}?>
]]></Value>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION><SCRIPTER.SCRIPTTYPE>JS</SCRIPTER.SCRIPTTYPE>]]></Meta>
                        </VAR>
                    </DOM>
                    <DOM ShortName="jsc">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.jsc.OnChanging-->
                        <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[when(..:Changing || (..Save:Changed && Reset)) {
	//Assembly
	var file = ..Save.File;
	if(file) {
		if(Reset)//delete dll for a new Compilation
			for(var ext in {"dll":1, "pdb":1, "js":1, "log":1})
				if(File.Exists(file + "." + ext))
					File.Delete(file + "." + ext);
		edvInfo = .{Library}.EDV.jsc.Server.SetScript({
			"master" : true
			, "root" : ..Save.Domains
			, "assembly" : file + ".dll"
			, "uid" : (..Version).Replace(".", "_")
		});
	}
}
null;
]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.jsc.Reset-->
                        <VAR ShortName="Reset" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean" SaveLocation="V" />
                    </DOM>
                    <DOM ShortName="Log">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.AddDate-->
                        <VAR ShortName="AddDate" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                            <Value><![CDATA[True]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.Destination-->
                        <VAR ShortName="Destination" ClassName="VarSelection" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Selection">
                            <Value><![CDATA[Console + Queue]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.Html-->
                        <VAR ShortName="Html" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<?=edv.{Library}.EDVServer.VarLog.Html(edvjs.Extend(arguments, {erase : (...:Domain)}), edvSender, arguments)?>
<?=edv.{Library}.EDVServer.VarLog.Html({}, .{Sys}.Error:Object, edvClient)?>]]></Value>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue-->
                        <VAR ShortName="LogQueue" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object" SaveLocation="V" />
                        <DOM ShortName="AddDate">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.AddDate.Format-->
                            <VAR ShortName="Format" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                <Value><![CDATA[HH:mm:ss.fff]]></Value>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Destination">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.Destination.Values-->
                            <VAR ShortName="Values" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Text">
                                <Value><![CDATA[Console
Console + File=
Console + Queue]]></Value>
                            </VAR>
                        </DOM>
                        <DOM ShortName="LogQueue">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Clear-->
                            <VAR ShortName="Clear" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Reduce-->
                            <VAR ShortName="Reduce" ClassName="EDVDelay@EDVFunctions" AutoReset="1" Securized="1" ReadOnly="1" ValueType="Boolean" />
                            <DOM ShortName="Clear">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Clear.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changing)
{
	if(... != null)
		... = new Queue();
}
null;]]></Script>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Reduce">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Reduce.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changing)
{
	var logQueue;
	if ((logQueue = ...) != null) {
		var count : int = logQueue.Count;
		for(; count > 128; count--)
			logQueue.Dequeue();
	}
}
null;]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Reduce.Period-->
                                <VAR ShortName="Period" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Double">
                                    <Value><![CDATA[86400000]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Reduce.Repeat-->
                                <VAR ShortName="Repeat" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[True]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Reduce.Start-->
                                <VAR ShortName="Start" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                                <DOM ShortName="Repeat">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.Log.LogQueue.Reduce.Repeat.OnChanging-->
                                    <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                        <Script><![CDATA[when(..)
{
	..Start;
}
null;]]></Script>
                                    </VAR>
                                </DOM>
                            </DOM>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Midnight">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Midnight.LastTime-->
                        <VAR ShortName="LastTime" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DateTime" SaveLocation="V" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Midnight.OnChanging-->
                        <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[when(..:Changing){
	LastTime = DateTime.Now;
	try {
		//Action

		//Reset à 1H du mat
		Period = (24 - DateTime.Now.Hour + 1) * 3600 * 1000;
		Start;
	}
	catch(ex){
		edvError = :Name + " : " + ex;
		Period = 10000;
		Start;
	}
}
null;]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Midnight.Period-->
                        <VAR ShortName="Period" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Double">
                            <Value><![CDATA[61200000]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Midnight.Start-->
                        <VAR ShortName="Start" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                    </DOM>
                    <DOM ShortName="OnLoad">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.OnLoad.Done-->
                        <VAR ShortName="Done" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean" SaveLocation="V" />
                    </DOM>
                    <DOM ShortName="Save">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.Backup-->
                        <VAR ShortName="Backup" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.Domains-->
                        <VAR ShortName="Domains" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Text">
                            <Script><![CDATA["^" + Regex.Escape(edvTools.ParentName(edvTools.ParentName(me.Parent.Domain))) + "($|\\.)";
]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.File-->
                        <VAR ShortName="File" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File" SaveLocation="V">
                            <Script><![CDATA[when(:Scripting && edvClient != null)
{
	var lsFile : String;
	if ((lsFile = edvClient.OpeningVarsFile) != null && lsFile != "" && !lsFile.StartsWith("<"))
		lsFile;
	else {
		edvInfo ="\t\t\tATTENTION : le fichier d'application n'est pas défini pour " + ..edvAppli:Domain;
	}
}]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.Local-->
                        <VAR ShortName="Local" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File" SaveLocation="V">
                            <Script><![CDATA[if(File.Exists)
	Path.GetDirectoryName(File) + "\\" + Path.GetFileNameWithoutExtension(File) + ".local.edvars";
else
	"";]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.OnChanging-->
                        <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[when(..){
	..Data.Save;

	var root = Domains;

	var fileName : String;
	var variables : VariableList;

	fileName = File;
	variables = edvars("^" + Regex.Escape(edvTools.ParentName(..edvAppli:Name)) + "(?!\\.EDVSTATS\\.{LOCAL}\\.)", -1);
	edvInfo = variables.Root  + " : " +  variables.Count;
	edvClient.SaveToVarsFile(fileName, VariableList(variables), new VariableListOptions(variables.Root));

	var varLocal = edvSender["..edvStats.{Local}"];
	if(varLocal != null){
		fileName = Local;
		variables = edvars(varLocal.Name, -1);
		edvClient.SaveToVarsFile(fileName, VariableList(variables), new VariableListOptions(variables.Root));
	}

	edvInfo = root + " est enregistré dans " + File;
}
null;]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.OnChecking-->
                        <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[when(..:Checking){
	var varLog = edvar(..:Domain + "log");
	if(varLog != null) varLog.Value = :Name;

	if (File == "") {
		edvError = "Impossible d'enregistrer l'application car le fichier d'origine est inconnu";
		.. = false;
	}
	else {
		Backup;
	}
}
null;]]></Script>
                        </VAR>
                        <DOM ShortName="Backup">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.Backup.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changing)
{	//Crée une sauvegarde dans le même répertoire en ajoutant un
	var lsFileSrc : String = ..File;
	if (lsFileSrc != "" && File.Exists(lsFileSrc))
	{
		var lsDir : String = .{SYS}.Path.Backup;
		if (Directory.Exists(lsDir) && lsFileSrc != "" && File.Exists(lsFileSrc))
		{
			var lsFileDest : String = String.Format("{0}\\{1}.{2}.edvars", lsDir, Path.GetFileNameWithoutExtension(lsFileSrc), DateTime.Now.ToString("yyMMdd.HHmmss.fff"));
			edvInfo = "Copie de sauvegarde dans " + lsFileDest;
			File.Copy(lsFileSrc, lsFileDest);
		}
	}
}
null;]]></Script>
                            </VAR>
                        </DOM>
                        <DOM ShortName="File">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.File.Exists-->
                            <VAR ShortName="Exists" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Boolean">
                                <Value><![CDATA[True]]></Value>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.File.Exists.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changing || :Scripting)
{
	..Save:ReadOnly = !(..);
}
null;]]></Script>
                                </VAR>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Local">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Save.Local.Exists-->
                            <VAR ShortName="Exists" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Boolean">
                                <Value><![CDATA[False]]></Value>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Session">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Session.Clone-->
                        <VAR ShortName="Clone" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                            <Value><![CDATA[False]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Session.Forbidden-->
                        <VAR ShortName="Forbidden" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                            <Value><![CDATA[False]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Session.OnChecking-->
                        <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[when(edvSender.NameUpper.StartsWith(".{CLIENTS}.") && .. && Forbidden) {
	..Errors += edvInfo = :Name + " - Clone interdit";
	..edvAppli = false;
	.. = false;
	var varAppli = ..edvAppli:Parent;
	if (varAppli != null && varAppli.ValueType == EDVType.Boolean)
		varAppli.Value = false;
}
null;]]></Script>
                        </VAR>
                        <DOM ShortName="Clone">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Session.Clone.OnScripting-->
                            <VAR ShortName="OnScripting" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(:Scripting || ..) {
	if(edvSender.NameUpper.StartsWith(".{CLIENTS}")){
		var varSource = edvar(edvTools.EnsureIsVariable(..edvAppli:Domain).Substring(edvSender.NameUpper.IndexOf(".", 12)));
		if(varSource == null)
			edvReturn(edvError = :Name + " - Impossible de trouver "  + edvTools.EnsureIsVariable(..edvAppli:Domain).Substring(edvSender.NameUpper.IndexOf(".", 12)));
		edvInfo = edvSender.NameUpper + newline + " CLONE(" + varSource.Name +  "  ,  " +  ..edvAppli:Domain + ")";
		edvClient.Clone(varSource.Name + ".", ..edvAppli:Domain);

		var variable;
		variable = ..edvAppli["..Visual.Html"];
		if(variable != null)
			variable.Name = Regex.Replace(variable.Name, Regex.Escape(varSource.NameUpper), varSource.Name, RegexOptions.IgnoreCase);

		variable = ..edvAppli["..Log"];
		if(variable != null && edvClient != null)
			edvClient.Variable(variable.Name.Substring(edvClient.DomClient.Length)).Value = "Connexion de " + edvClient.ToString();
	}
}
null;]]></Script>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Update">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Update.EDVVisual-->
                        <VAR ShortName="EDVVisual" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File">
                            <Script><![CDATA[.{Sys}.Path.Bin + "\\EDVVisual.exe"]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Update.OnChanging-->
                        <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[/*when(..:Changing)
{
	..Visual.WIN.Close;
	..Data.Save;
	..BBSacs = false;
	
	var varUpdate = edvClient.Variable(..BBSacs:Domain + "edvUpdate", EDVType.Boolean);
	varUpdate.Asynchron = true;
	var varScript = edvClient.Variable(..BBSacs:Domain + "edvUpdate.OnChanging", EDVType.Boolean);
	varScript.Script = "when(..){"
			+"\n edvInfo = 'début de la mise à jour';"
			+"\n var file = ..BBSacs.Global.SaveAppli.File;"
			+"\n edvClient.Remove(..BBSacs:NameUpper);"
			+"//\n edvClient.OpenVarsFile(file, DOM.ROOT)"
			+"//\n edvInfo = \"Application rechargée\";"
			+"\n edvClient.Remove(..:Name)"
			+"\n}null;";
	varUpdate.Value = true;
}
null;]]></Script>
                        </VAR>
                        <DOM ShortName="EDVVisual">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Update.EDVVisual.Arguments-->
                            <VAR ShortName="Arguments" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Update.EDVVisual.Open-->
                            <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                        </DOM>
                    </DOM>
                    <DOM ShortName="User">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data-->
                        <VAR ShortName="Data" ClassName="VarDataTable" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DataTable">
                            <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="XML"><xs:complexType><xs:sequence><xs:element name="IdParam" msdata:Caption="" type="xs:string" /><xs:element name="Value" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Visual" msdata:Caption="" type="xs:boolean" minOccurs="0" /><xs:element name="Title" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="UserLevel" msdata:Caption="" type="xs:int" minOccurs="0" /><xs:element name="Category" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="SortIndex" type="xs:int" minOccurs="0" /><xs:element name="Unit" msdata:Caption="" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="XML" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element ref="XML" /></xs:choice></xs:complexType><xs:unique name="Constraint1" msdata:PrimaryKey="true"><xs:selector xpath=".//XML" /><xs:field xpath="IdParam" /></xs:unique></xs:element></xs:schema></Schema><Data /></DataTable>]]></Value>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Id-->
                        <VAR ShortName="Id" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                            <Value><![CDATA[admin]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login-->
                        <VAR ShortName="Login" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean" SaveLocation="V" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Name-->
                        <VAR ShortName="Name" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" SaveLocation="V" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.NeedLogin-->
                        <VAR ShortName="NeedLogin" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                            <Value><![CDATA[True]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Users-->
                        <VAR ShortName="Users" ClassName="VarLink" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Link" />
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual-->
                        <VAR ShortName="Visual" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual">
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>HTML</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <DOM ShortName="Data">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data._Description-->
                            <VAR ShortName="_Description" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<pre class="edvDescription"><?=..:Name?>
Gère les variables dont le SaveLocation est positionné sur User.
- Les données sont enregistrées dans des fichiers <code>&lt;?=..edvAppli.Save.File?&gt;</code>.user.<code>&lt;?=..User.Id?&gt;</code>.xml.
- Open quand User.Id <> ""
- Save depuis User.Login.OnChecking, à la déconnexion
</pre>]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Model-->
                            <VAR ShortName="Model" ClassName="VarDataTable" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DataTable">
                                <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="Internal"><xs:complexType><xs:sequence><xs:element name="IdParam" msdata:Caption="" type="xs:string" /><xs:element name="Value" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Visual" msdata:Caption="" type="xs:boolean" minOccurs="0" /><xs:element name="Title" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="UserLevel" msdata:Caption="" type="xs:int" minOccurs="0" /><xs:element name="Category" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="SortIndex" type="xs:int" minOccurs="0" /><xs:element name="Unit" msdata:Caption="" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="Internal" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element ref="Internal" /></xs:choice></xs:complexType><xs:unique name="Constraint1" msdata:PrimaryKey="true"><xs:selector xpath=".//Internal" /><xs:field xpath="IdParam" /></xs:unique></xs:element></xs:schema></Schema><Data><DocumentElement /></Data></DataTable>]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Open-->
                            <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="1" ReadOnly="1" ValueType="Boolean">
                                <Script><![CDATA[..Id != ""]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Save-->
                            <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Source-->
                            <VAR ShortName="Source" ClassName="VarDataSource" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Text">
                                <Script><![CDATA["Provider=XML;Data Source=" + :DBName]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Validate-->
                            <VAR ShortName="Validate" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <DOM ShortName="Model">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Model.Save-->
                                <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Model.Save.OnChanging-->
                                    <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                        <Script><![CDATA[when(..)
{
	var lVarRoot = ..edvAppli:Parent;
	var lModelTable = ...;

	for(var lVar in edvClient.GetVariables(..edvAppli:Domain).Values)
		if (EDV.SaveLocation.ContainsLocation(lVar.SaveLocation, EDV.SaveLocation.User)
		&& lModelTable.Select("IdParam = '" + lVar.Name + "'"
			+ " OR IdParam = '" + lVar.Name.Substring(lVarRoot.Name.Length+1) + "'").Length == 0) {
				var newRow = lModelTable.NewRow();
				newRow[0] = lVar.Name.Substring(lVarRoot.Name.Length+1);
				newRow[1] = lVar.Value;
				newRow["SortIndex"] = 999;
				lModelTable.Rows.Add(newRow);

		}

	var rows = lModelTable.Select("", "SortIndex");
	lModelTable = lModelTable.Clone();
	for(var row in rows.GetEnumerator()){
		var newRow = lModelTable.NewRow();
		newRow.ItemArray = row.ItemArray;
		lModelTable.Rows.Add(newRow);
	}
	... = lModelTable;
}
]]></Script>
                                    </VAR>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Open">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Open.OnChanged-->
                                <VAR ShortName="OnChanged" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changed) {
	edvInfo = :Name + " : Chargement des paramètres de l'utilisateur.";
	var dataTable = ...;
	var lVarRoot =..edvAppli:Parent;
	if (lVarRoot != null){
		for(var lRow : DataRow in dataTable.Select("", "SortIndex").GetEnumerator()) {
			var lVarName = lRow["IdParam"];
			var lVar = null;

			lVar = lVarRoot[lVarName];
			if (lVar != null){
				if(!lRow.IsNull("Value"))
					lVar.Value = lRow["Value"];
			}
			else
				edvInfo = :Name + " : la donnée sauvegardée '" + lVarName + "' ne correspond à aucune variable.";
		}
	}
}
null;]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Open.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changing) {
	var dataTable = ...;
	if (!dataTable.Columns.Contains("SortIndex"))
		dataTable.Columns.Add("SortIndex", Int32);
	if (!dataTable.Columns.Contains("Unit"))
		dataTable.Columns.Add("Unit", String);

	var modelTable = ..Model;
	var rows;
	for(var modelRow in modelTable.Rows) {
		if((rows = dataTable.Select("IdParam='" + modelRow["IdParam"] + "'")).Length==0) {
			var newRow = dataTable.NewRow();
			for(var column in dataTable.Columns)
				newRow[column] = modelRow[column.ColumnName];
			dataTable.Rows.Add(newRow);
		}
		else {
			rows[0]["Visual"] = modelRow["Visual"];
			rows[0]["Title"] = modelRow["Title"];
			rows[0]["UserLevel"] = modelRow["UserLevel"];
			rows[0]["Category"] = modelRow["Category"];
			rows[0]["SortIndex"] = modelRow["SortIndex"];
			rows[0]["Unit"] = modelRow["Unit"];
		}
	}

	/*//set sorted table
	var rows = dataTable.Select("", "SortIndex");
	dataTable = dataTable.Clone();
	for(var row in rows.GetEnumerator()){
		var newRow = dataTable.NewRow();
		newRow.ItemArray = row.ItemArray;
		dataTable.Rows.Add(newRow);
	}
	... = dataTable;
	*/
}
null;
]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Open.OnChecking-->
                                <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Checking)
	if(..Source.DBName == "" || !File.Exists(..Source.DBName)){
		.. = false;
	}
null;]]></Script>
                                </VAR>
                                <DOM ShortName="OnChanged">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Open.OnChanged._Script-->
                                    <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[when(..:Changed) {
	edvInfo = :Name + " : Chargement des paramètres de l'utilisateur.";
	var dataTable = ...;
	var lVarRoot =..edvAppli:Parent;
	if (lVarRoot != null){
		for(var lRow : DataRow in dataTable.Select("", "SortIndex").GetEnumerator()) {
			var lVarName = lRow["IdParam"];
			var lVar = null;

			lVar = lVarRoot[lVarName];
			if (lVar != null){
				if(!lRow.IsNull("Value"))
					lVar.Value = lRow["Value"];
			}
			else
				edvInfo = :Name + " : la donnée sauvegardée '" + lVarName + "' ne correspond à aucune variable.";
		}
	}
}
null;]]></Value>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="Save">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Save.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..){
	edvInfo = :Name + " : Enregistrement des paramètres de l'utilisateur.";
	var lVarRoot;
	if ((lVarRoot = ..edvAppli:Parent) != null) {
		var lDataTable = ...;
		for(var lRow in lDataTable.Rows) {
			var lVar = lVarRoot[lRow["IdParam"]];
			if (lVar != null)
				lRow["Value"] = lVar.Value;
			else
				edvError = :Name + "\t\t\tLe paramètre " + lRow["IdParam"] + " n'existe pas en référence à " + lVarRoot.Name;
		}
		..Validate;
	}
}
]]></Script>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Source">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Source.DBName-->
                                <VAR ShortName="DBName" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                                    <Script><![CDATA[var lsFile = ..Save.File;//Fichier .edvars d'où est chargé l'application
if (lsFile != "" && !lsFile.StartsWith("\t\t\tATTENTION")) lsFile.substring(0, lsFile.length-".edvars".length) + ".user." + ..Id + ".xml";
else "";
]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Source.DBPassword-->
                                <VAR ShortName="DBPassword" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Password" />
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Source.DBServer-->
                                <VAR ShortName="DBServer" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Source.DBType-->
                                <VAR ShortName="DBType" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[XML]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Data.Source.DBUser-->
                                <VAR ShortName="DBUser" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                            </DOM>
                        </DOM>
                        <DOM ShortName="Login">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Check-->
                            <VAR ShortName="Check" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?//requested from page
if (arguments){
	var user;
	var users = ..Users:Object;
	var apps = ["EDVServer", ..ApplicationId];
	
	if (arguments.UserKey && arguments.UserKey != ""
	&& (user = users["GetUser"].Value(arguments.UserKey, arguments.Password, apps, edvClient)) != null) {
		UserKey = arguments.UserKey;
		..User = user;
		..User.Name = user.Name;
		..User.Id = user.IdUser;
		
		.. = true;
		
		var logName = edvTools.NameWithoutDomClient(..Log:Name);//Master log if in client session
		edvClient.Variable(logName).Value 	= "Connexion de " + edvClient.ToString() 
			+ " - " + edvjs.json(edvjs.Extend({}, user, {password: "********"});			

		echo("Ok");
	}
	else {
		echo("Identifiant ou mot de passe incorrecte.");
	}
}	
else 
	echo("Recherche inconnue.");
?>]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.OnChecking-->
                            <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Checking && !..) {
	if(..Id)
		..Data.Save;
	... = null;
	..Id = "";
	..Name = "";
}
null;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.UserKey-->
                            <VAR ShortName="UserKey" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" SaveLocation="VX" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual-->
                            <VAR ShortName="Visual" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual">
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>HTML</DESIGNER.LASTPRESENTATION>]]></Meta>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.HTML-->
                                <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<div id="dlgUserLogin" title="<?=..Title?> : Connexion">
	<table>
	<tr><td>Utilisateur :<td><INPUT id="UserLogin-UserKey" value="<?=unescape((arguments && arguments.UserKey) ? arguments.UserKey : ..UserKey)?>"
		onkeypress="if (getKeyPress(event)==13) UserLoginCheck();"
			size="18">
	<tr><td>Mot de passe :<td><INPUT id="UserLogin-Password" value="" type="password"
		onkeypress="if (getKeyPress(event)==13) UserLoginCheck();"
		size="12">
	</table>
</div>

<script>
$(document).ready(function() {
	edv.Appli.Enabled = false;
	$("#dlgUserLogin").dialog({ 
		autoOpen: true,
		modal: true,
		buttons: { "Ok": function() { UserLoginCheck(); } },
		open: function(event, ui) {
			if (<?=!..Login?>) 
				$(this.parentNode).children(".ui-dialog-titlebar").children(".ui-dialog-titlebar-close").hide();
			},
		closeOnEscape: false,
		resizable: false,
		width : 400
	});
});

function UserLoginCheck(){
	var userKey = document.getElementById("UserLogin-UserKey").value;
	if (userKey == ""){
		alert("Veuillez saisir l'identifiant de connexion.");
		return false;
	}
	var password = document.getElementById("UserLogin-Password").value;
	if(!password){
		$("#UserLogin-Password").focus();
		return;
	}
	edv.Wait.Show();
	var check = edvGetVar("<?=..Check:Name?>",'edvargs={UserKey: "' + userKey + '", Password: "' + password + '"}', undefined, "code");
	
	if (check == "Ok"){
		document.location.href = "<?=(arguments && arguments.Url) ? arguments.Url : ..Url?>";
		return true;
	}
	edv.Wait.Hide();
	alert(check);
	return false;
}	
</script>]]></Value>
                                    <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN-->
                                <VAR ShortName="WIN" ClassName="WinForm@EDVVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[True]]></Value>
                                </VAR>
                                <DOM ShortName="HTML">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.HTML.CSS-->
                                    <VAR ShortName="CSS" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<?=edv.{Web}.CSS(edvSender)?>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.HTML.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<?=edv.{Web}.HEAD(edvSender)?>
<?=..edvAppli.HTML.Head?>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.HTML.Main-->
                                    <VAR ShortName="Main" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual">
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.HTML.Main.HTML-->
                                        <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[<?=edv.{Web}.Main(edvSender)?><?/*remplacez par 'edv.{Web}.Main.Value', surlignez tout puis F9 pour avoir le script*/?>]]></Value>
                                        </VAR>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="WIN">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLLABEL1-->
                                    <VAR ShortName="CTRLLABEL1" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object" />
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLTEXTBOX1-->
                                    <VAR ShortName="CTRLTEXTBOX1" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object" />
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.Font-->
                                    <VAR ShortName="Font" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[[Font:Name=Microsoft Sans Serif,Size=9,Bold=False,Italic=False,Underline=False,Strikeout=False]]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.Height-->
                                    <VAR ShortName="Height" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[82]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.Width-->
                                    <VAR ShortName="Width" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[206]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.WindowStartPosition-->
                                    <VAR ShortName="WindowStartPosition" ClassName="FormStartPosition@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[Manual]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.WindowState-->
                                    <VAR ShortName="WindowState" ClassName="FormWindowState@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[Normal]]></Value>
                                    </VAR>
                                    <DOM ShortName="ctrlLabel">
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLabel.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLabel._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[System.Windows.Forms.Label]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLabel.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=0,Y=4,Width=47,Height=15}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLabel.Text-->
                                        <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Nom :]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="CTRLLABEL1">
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLLABEL1.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLLABEL1._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[System.Windows.Forms.Label]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLLABEL1.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=0,Y=32,Width=96,Height=17}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLLABEL1.Text-->
                                        <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Mot de passe :]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlLinkLabel">
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLinkLabel.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLinkLabel._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[System.Windows.Forms.LinkLabel]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLinkLabel.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=66,Y=66,Width=66,Height=15}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlLinkLabel.Text-->
                                        <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Connexion]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlTextBox">
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlTextBox.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlTextBox._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[System.Windows.Forms.TextBox]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlTextBox.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=100,Y=1,Width=100,Height=21}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.ctrlTextBox.Text-->
                                        <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    </DOM>
                                    <DOM ShortName="CTRLTEXTBOX1">
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLTEXTBOX1.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLTEXTBOX1._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[System.Windows.Forms.TextBox]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLTEXTBOX1.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=100,Y=28,Width=100,Height=21}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLTEXTBOX1.PasswordChar-->
                                        <VAR ShortName="PasswordChar" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[*]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Login.Visual.WIN.CTRLTEXTBOX1.Text-->
                                        <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    </DOM>
                                </DOM>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Users">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Users.@-->
                            <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                <Value><![CDATA[.EDV.CoopEShop.edvAppli.User.Users]]></Value>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Visual">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual.HTML-->
                            <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?if(..User.Name != "") {
?><a href="" class="imgEDVTypeEDV" onclick="$('#dlgEditUser').dialog('open');return false;">&nbsp;&nbsp;&nbsp;Utilisateur <?=..Name?></a>
<form id="dlgEditUser" class="EDVVisual" method="post" name="<?=..:Name?>" title="<?=..Name?> (<?=..Id?>)">
	<pre><?=edvjs.json(..User)?></pre>
	
	</fieldset>
	
</form>
</div>

<script type="text/javascript">

	$(document).ready(function() {
		edv.Appli.Enabled = false;
	    	$("#dlgEditUser").dialog({ 
					autoOpen: true,
					modal: true,
					buttons: { "Ok": function() {$("#dlgEditUser").dialog('close'); }
					},
					closeOnEscape: true,
					resizable: true,
					width : 500
					}
		);
	});
	
</script>
<?}?>]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual.HTML.A-->
                                <VAR ShortName="A" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<?=edv.{HTML}.ICON({EDVType: 'EDV'})?><a href="#utilisateur" onclick="edv.HTMLElement.Replace(this,'<?=..:Name?>',null,null,'code');return false;"><?=..User.Name?></a>]]></Value>
                                    <Meta><![CDATA[<SCRIPTER.SCRIPTTYPE>HTML</SCRIPTER.SCRIPTTYPE><DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual.HTML.CSS-->
                                <VAR ShortName="CSS" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<?=edv.{Web}.CSS(edvSender)?>]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual.HTML.Head-->
                                <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<?=edv.{Web}.HEAD(edvSender)?>
<?=..edvAppli.HTML.Head({Url : ...:Name+".edvvisual"})?>
]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual.HTML.Main-->
                                <VAR ShortName="Main" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual">
                                    <!--.{Applications}.CoopEShop.Admin.edvAppli.User.Visual.HTML.Main.HTML-->
                                    <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<?=edv.{Web}.Main(edvSender)?><?/*remplacez par 'edv.{Web}.Main.Value', surlignez tout puis F9 pour avoir le script*/?>]]></Value>
                                    </VAR>
                                </VAR>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Version">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Version.Build-->
                        <VAR ShortName="Build" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                            <Value><![CDATA[0]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Version.Major-->
                        <VAR ShortName="Major" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                            <Value><![CDATA[1]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Version.Minor-->
                        <VAR ShortName="Minor" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                            <Value><![CDATA[0]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Version.Revision-->
                        <VAR ShortName="Revision" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Integer">
                            <Value><![CDATA[9]]></Value>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Version.Revision.OnSaving-->
                            <VAR ShortName="OnSaving" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..Save:Checking)
{
	..+=1;
}
else when(..Major:Changing || ..Minor:Changing || ..Build:Changing)
	.. = 0;
null;]]></Script>
                            </VAR>
                        </VAR>
                    </DOM>
                    <DOM ShortName="Visual">
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.HTML-->
                        <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<?var value;
if(value = ..edvAppli.Errors){
	?><pre class="edvError"><?=edvTools.EscapeHtml(value)?></pre>
<?}
var varRoot = ..edvAppli:Parent;
if(varRoot==null) varRoot = edvClient.Variable(edvTools.ParentName(..edvAppli:Name), EDVType.Domain);
?>
<a class="edvAppliSave" onclick="alert(edvGet('<?=VAR.INFO?>','<?=varRoot.Name?>.edvAppli.Save=true'));return false;">
	Enregistrer l'application</a>

<form class="EDVVisual" method="post" name="frmAppliParams" action="?">

<fieldset><legend>Paramètres</legend>
<input type="hidden" name="edvroot" value="<?=varRoot == null ? "" : varRoot.Name?>">

<ol class="params">
<?
var lCategory = null;
for(var lRow in ..Data:Select("Visual", "SortIndex, Category, Title, IdParam")) {
	var category = lRow.IsNull("Category") ? "" : lRow["Category"];
	if (lCategory != category){
		if (lCategory != null) echo("</ol></li>");
		lCategory = category;
		?><li><ol class="sub"><h3><?=category?></h3>
		<?
	}
	var text = lRow["Title"];
	if (text == null || text == "")
		text = lRow["IdParam"];
	var varProp = varRoot[lRow["IdParam"]];
	?><li>
	<label class="edvicon imgEDVType<?=edvTools.ImageKeyOfVar(varProp)?>"><?=text?> : </label>
	<span><?=edv.HTML.INPUT(varProp)?>
	<?=edv.{HTML}.edvar(varRoot[lRow["IdParam"]])?><?
	if(!lRow.IsNull("Unit") && lRow["Unit"] != "") {?>&nbsp;<?=edvTools.EscapeHtml(lRow["Unit"])?><?}
	?></span><?
}
if (lCategory != null) echo("</ol>");
?><br/>
	<li class="edvimg EDVTypeFile"><a class="submit" href="?"
		onclick="edv.Wait.Show();edvSubmit(document.forms['frmAppliParams']);">Enregistrer</a>
</ol>

</fieldset>
</form>

<div style="padding-left:10px; border-top : 1px solid gray">
	
	<br/><br/><u>Notes : </u>
	<ul>
	<li></li>
	</ul>
	
	<code>
		Fichier d'origine : <?=..Save.File?>
		<br/>Source des paramètres : <?=..Data.Source?>
	</code>
	
	<br/><br/>
	<div id="divLog" name="<?=..Log.Html:Name?>"></div>
</div>
<script>
	edvGetHtml("divLog")
	edv.Wait.Hide();
</script>

]]></Value>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN-->
                        <VAR ShortName="WIN" ClassName="WinForm@EDVVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                            <Value><![CDATA[False]]></Value>
                        </VAR>
                        <DOM ShortName="HTML">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.HTML.CSS-->
                            <VAR ShortName="CSS" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?=edv.{Web}.CSS(edvSender)?>
<style>
	#MainInner {
		padding-left : 10%;
		padding-right : 5%;
	}

	ol.params, ol.params ol.sub {
		padding-left : 0px;
		margin : 0px 0px 0px 0.5em;
		list-style : none;
		list-style : none;
	}
	ol.sub h3 {
		padding : 0px;
		margin: 0px;
	}
	ol.params ol.sub li {
		clear:both;
		margin-left : 1em;
	}
	ol.params label {
		float : left;
		min-width : 10em;
	}
	ol.params a.submit {
		background-color : white; 
		margin : 1em;
		padding: 3px;
		margin-top : -3px;
		font-size : larger
	}

	a.edvAppliSave {
		color:darkblue;
		position:absolute;
		right:1em;
		top:0px;
		font-size:smaller;
	}
</style>
]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.HTML.Head-->
                            <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?=edv.{Web}.HEAD(edvSender)?>
<?=..edvAppli.HTML.Head({Url : ...:Name+".edvvisual"})?>]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.HTML.Main-->
                            <VAR ShortName="Main" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.HTML.Main.HTML-->
                                <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<?=edv.{Web}.Main(edvSender, arguments, edvClient)?><?/*remplacez par 'edv.{Web}.Main.Value', surlignez tout puis F9 pour avoir le script*/?>
]]></Value>
                                </VAR>
                            </VAR>
                        </DOM>
                        <DOM ShortName="WIN">
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.Height-->
                            <VAR ShortName="Height" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                <Value><![CDATA[232]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.OnShown-->
                            <VAR ShortName="OnShown" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[edvctrl(":ctrlHTML").Size = edvWinForm.Size;
edvctrl(":ctrlHTML").Anchor = AnchorStyles.Left | AnchorStyles.Top | AnchorStyles.Bottom | AnchorStyles.Right
]]></Value>
                                <Meta><![CDATA[<SCRIPTER.SCRIPTTYPE>Script</SCRIPTER.SCRIPTTYPE>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.Show-->
                            <VAR ShortName="Show" ClassName="ShowWin@EDVVisual" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" Control="EDV.EDVVisual.CtrlShowWin@EDVVisual.exe" />
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.Width-->
                            <VAR ShortName="Width" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                <Value><![CDATA[271]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.WindowStartPosition-->
                            <VAR ShortName="WindowStartPosition" ClassName="FormStartPosition@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                <Value><![CDATA[Manual]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.WindowState-->
                            <VAR ShortName="WindowState" ClassName="FormWindowState@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                <Value><![CDATA[Normal]]></Value>
                            </VAR>
                            <DOM ShortName="ctrlHTML">
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.ctrlHTML.@-->
                                <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[:HTML]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.ctrlHTML._ClassName-->
                                <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[EDVCtrlWebBrowser]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvAppli.Visual.WIN.ctrlHTML.Bounds-->
                                <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                    <Value><![CDATA[{X=1,Y=2,Width=270,Height=231}]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                    </DOM>
                </DOM>
                <DOM ShortName="edvStats">
                    <!--.{Applications}.CoopEShop.Admin.edvStats.DesignMode-->
                    <VAR ShortName="DesignMode" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean" SaveLocation="V" />
                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli-->
                    <VAR ShortName="edvAppli" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean" SaveLocation="V">
                        <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander-->
                    <VAR ShortName="edvExpander" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                        <Script><![CDATA[.{Applications}.edvStats.edvExpander]]></Script>
                        <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur-->
                    <VAR ShortName="Fournisseur" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Domain" />
                    <!--.{Applications}.CoopEShop.Admin.edvStats.Icon-->
                    <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                        <Value><![CDATA[EDV]]></Value>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvStats.Visual-->
                    <VAR ShortName="Visual" ClassName="VarVisual" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Visual">
                        <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>HTML</DESIGNER.LASTPRESENTATION>]]></Meta>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvStats.{Local}-->
                    <VAR ShortName="{Local}" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                        <Value><![CDATA[Requêtes locales]]></Value>
                    </VAR>
                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}-->
                    <VAR ShortName="{System}" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                        <Value><![CDATA[Système]]></Value>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}._Index-->
                        <VAR ShortName="_Index" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Integer">
                            <Value><![CDATA[999]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.DefaultDataSource-->
                        <VAR ShortName="DefaultDataSource" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                            <Value><![CDATA[Source de données par défaut]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables-->
                        <VAR ShortName="EDVariables" ClassName="VarDataTable" AutoReset="0" Securized="0" ReadOnly="0" ValueType="DataTable">
                            <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="EDV" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element name="EDV"><xs:complexType><xs:sequence><xs:element name="ShortName" type="xs:string" minOccurs="0" /><xs:element name="Domain" type="xs:string" minOccurs="0" /><xs:element name="ValueType" type="xs:string" minOccurs="0" /><xs:element name="ImageKey" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element></xs:choice></xs:complexType></xs:element></xs:schema></Schema><Data /></DataTable>]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvDocument-->
                        <VAR ShortName="edvDocument" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<?=.{HTML}.edvStat.Expander(edvjs.Extend({"provider" : "Document"}, arguments), edvSender["edvSQL"], edvClient)?>
<p>
<?=.{HTML}.edvStat.Expander(arguments, edvSender["EDVariables"], edvClient)?>
</p>
<p><?=.{HTML}.edvStat.Expander(edvjs.Extend({"provider" : "Document"}, arguments), edvSender["DefaultDataSource"], edvClient)?>
</p>]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL-->
                        <VAR ShortName="edvSQL" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                            <Value><![CDATA[Requêteur SQL]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.Icon-->
                        <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                            <Value><![CDATA[Null]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.Visible-->
                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                            <Value><![CDATA[True]]></Value>
                        </VAR>
                        <DOM ShortName="DefaultDataSource">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.DefaultDataSource.edvDocument-->
                            <VAR ShortName="edvDocument" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<param class="edvDialogOption" name="title" value="Source de données"/>
<param class="edvDialogOption" name="width" value="auto"/>
<param class="edvDialogOption" name="height" value="auto"/>
<?var varDS = edvClient.GetVarLinked(..edvAppli.DataSource:Object);
if(varDS.Scripted) varDS = varDS.Parent["." + varDS.Script]; //TODO ! Implicite, script is a relative name
?><?=edv.{HTML}.edvStat(.{Applications}.edvStats.{System}.DataSources.DefaultDataSource:Object, {
    "SQLSelect" : {"VarRoot" : varDS.Name
}
}, edvClient)?>]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.DefaultDataSource.Icon-->
                            <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[VisualTrue]]></Value>
                            </VAR>
                            <DOM ShortName="edvDocument">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.DefaultDataSource.edvDocument._Where-->
                                <VAR ShortName="_Where" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                                    <Script><![CDATA[EDVScriptCode.PrepareCode(edvClient, ...:Object, ..)]]></Script>
                                    <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Visible">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.DefaultDataSource.Visible.DesignOnly-->
                                <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="EDVariables">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.edvStat-->
                            <VAR ShortName="edvStat" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Object" SaveLocation="V">
                                <Script><![CDATA[me = null]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Error-->
                            <VAR ShortName="Error" ClassName="VarLog" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" SaveLocation="V" Control="EDVCtrlLog" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Icon-->
                            <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[EDV]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Open-->
                            <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="0" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row-->
                            <VAR ShortName="Row" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                                <Value><![CDATA[-1]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.RowsCount-->
                            <VAR ShortName="RowsCount" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer">
                                <Value><![CDATA[0]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source-->
                            <VAR ShortName="Source" ClassName="VarDataSource" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Text">
                                <Script><![CDATA["Provider=EDV;Data Source=" + :DBName + ";User Id=" + :DBUser + ";Password=" + :DBPassword;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect-->
                            <VAR ShortName="SQLSelect" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[SELECT ShortName, Domain, ValueType, ImageKey
FROM <?if(:SUBDOMAIN){
    echo(edvTools.EnsureIsDomain(:SUBDOMAIN));
    :SUBDOMAIN = "";
}
else if(:ROOTDOMAIN)
    echo(edvTools.EnsureIsDomain(:ROOTDOMAIN));
else
    echo(:Domain);?>
DEPTH 0]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Status-->
                            <VAR ShortName="Status" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer" SaveLocation="V" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Text-->
                            <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[Variables EDV]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Visible-->
                            <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[True]]></Value>
                            </VAR>
                            <DOM ShortName="Row">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain-->
                                <VAR ShortName="Domain" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ImageKey-->
                                <VAR ShortName="ImageKey" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName-->
                                <VAR ShortName="ShortName" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ValueType-->
                                <VAR ShortName="ValueType" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <DOM ShortName="_table">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.css-->
                                    <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[background-color: white;
]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.cssBody-->
                                    <VAR ShortName="cssBody" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[background-color: white;
]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[<?=this.RowsCount == 0 ? "aucune ligne"
	: this.RowsCount == 1 ? "une ligne"
	: this.RowsCount + " lignes"?> dans <?=:Name?>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Rotate-->
                                    <VAR ShortName="Rotate" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                    <DOM ShortName="Foot">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Foot.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Head">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Head.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[font-style: italic;]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Head.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row._table.Head.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="Domain">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<?=HTML.edvExpander({
    'edvSender' : this.Value("Domain") + this.Value("ShortName")
    , 'provider' : this.Value("ValueType") == EDVType.DataTable 
        ? '.{HTML}.edvStat'
        : '.{HTML}.edvEditor'
    , 'icon' : this.Value("ValueType") == EDVType.DataTable 
        ? 'imgEDVTypeVisualTrue' : 'edvimgEdit'
    , 'destination' : "edvDialog"
    , 'text' : ''
    , "edvDialogOptions" : {
		"title" : this.Value("Domain") + this.Value("ShortName"),
		"modal" : false,
		"buttons" : false
    }
    , 'toolBar' : false
    , 'providerArgs' : {
        'onSubmit' : 'edvSubmit(this); edvDialog(this).Close(); return false;'
    }
})?>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Domaine]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[float:right;
min-width: 3.4em;
]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Head">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.Domain.Head.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[display: none]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="ImageKey">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ImageKey.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ImageKey.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="ShortName">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<span class="edvExpander" name="edvcode=.{HTML}.edvStat&edvSender=<?=:Name?>">
<span class="edvicon imgEDVType<?=this.Value("ImageKey")?>"><?=this.Value()?></span>
<param class="edvExpanderArgs" name="SQLSelect.SUBDOMAIN" value="<?=this.Value("Domain") + this.Value("ShortName")?>"/>
</span>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Variable]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[min-width: 12em;
}
table {
padding: 0px;
margin: 0px;
]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Head">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ShortName.Head.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[display: none]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="ValueType">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ValueType.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ValueType.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Type]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Row.ValueType.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="Source">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source._Script-->
                                <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                                    <Script><![CDATA[var rows = (.{HTML}.edvStat.DataSources.DSList).Select("Id = '" + ..Source.Id + "'");
if(rows.length > 0) echo(rows[0]["Script"])
else echo("/*source EDV inconnue*/")]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source.DBName-->
                                <VAR ShortName="DBName" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source.DBPassword-->
                                <VAR ShortName="DBPassword" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Password" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source.DBServer-->
                                <VAR ShortName="DBServer" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source.DBType-->
                                <VAR ShortName="DBType" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[EDV]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source.DBUser-->
                                <VAR ShortName="DBUser" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Source.Id-->
                                <VAR ShortName="Id" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="VariableName">
                                    <Value><![CDATA[EDV]]></Value>
                                </VAR>
                            </DOM>
                            <DOM ShortName="SQLSelect">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.ROOTDOMAIN-->
                                <VAR ShortName="ROOTDOMAIN" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Text">
                                    <Value><![CDATA[.QV]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.SUBDOMAIN-->
                                <VAR ShortName="SUBDOMAIN" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="VariableName" />
                                <DOM ShortName="ROOTDOMAIN">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.ROOTDOMAIN.DesignOnly-->
                                    <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.ROOTDOMAIN.Text-->
                                    <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Racine]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="SUBDOMAIN">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.SUBDOMAIN.DesignOnly-->
                                    <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[True]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.SUBDOMAIN.Text-->
                                    <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[(récursion)]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="WhereThis">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.WhereThis.DesignOnly-->
                                    <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[True]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.SQLSelect.WhereThis.Text-->
                                    <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Where (this)]]></Value>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="Visible">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.EDVariables.Visible.DesignOnly-->
                                <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="edvDocument">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvDocument._Where-->
                            <VAR ShortName="_Where" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                                <Script><![CDATA[EDVScriptCode.PrepareCode(edvClient, ...:Object, ..)]]></Script>
                            </VAR>
                        </DOM>
                        <DOM ShortName="edvSQL">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.edvDocument-->
                            <VAR ShortName="edvDocument" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?=.{Applications}.edvStats.edvSQL.edvDocument(arguments, edvSender, edvClient)?>
]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Icon-->
                            <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[VisualTrue]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query-->
                            <VAR ShortName="Query" ClassName="VarDataTable" AutoReset="0" Securized="0" ReadOnly="0" ValueType="DataTable" SaveLocation="V">
                                <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="MySQL" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element name="MySQL"><xs:complexType><xs:sequence><xs:element name="IdUser" type="xs:int" minOccurs="0" /><xs:element name="Enabled" type="xs:short" minOccurs="0" /><xs:element name="UserType" type="xs:short" minOccurs="0" /><xs:element name="ContactType" type="xs:string" minOccurs="0" /><xs:element name="Name" type="xs:string" minOccurs="0" /><xs:element name="ShortName" type="xs:string" minOccurs="0" /><xs:element name="EMail" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element></xs:choice></xs:complexType></xs:element></xs:schema></Schema></DataTable>]]></Value>
                            </VAR>
                            <DOM ShortName="edvDocument">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.edvDocument._Where-->
                                <VAR ShortName="_Where" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                                    <Script><![CDATA[EDVScriptCode.PrepareCode(edvClient, ...:Object, ..)]]></Script>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Query">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.Close-->
                                <VAR ShortName="Close" ClassName="" AutoReset="1" Securized="0" ReadOnly="0" ValueType="Boolean" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.Error-->
                                <VAR ShortName="Error" ClassName="VarLog" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" SaveLocation="V" Control="EDVCtrlLog" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.Open-->
                                <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="0" ReadOnly="0" ValueType="Boolean" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.SQLSelect-->
                                <VAR ShortName="SQLSelect" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[SELECT U.IdUser, U.Enabled, U.UserType, C.ContactType, C.Name, C.ShortName, C.EMail
FROM contact C
JOIN user U ON C.IdContact = u.IdUser]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.Status-->
                                <VAR ShortName="Status" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer" SaveLocation="V" />
                                <DOM ShortName="Error">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.Error.OnChanging-->
                                    <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Null">
                                        <Script><![CDATA[when(.. != "")
{
	throw new EDVException(..);
}
null;]]></Script>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="RowsCount">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.RowsCount.Limit-->
                                    <VAR ShortName="Limit" ClassName="VarSelection" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Selection">
                                        <Value><![CDATA[-1]]></Value>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Query.RowsCount.Limit.Values-->
                                        <VAR ShortName="Values" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Text">
                                            <Value><![CDATA[1
10
20
50
100
300
1000
-1	(toutes)]]></Value>
                                        </VAR>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="Visible">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.edvSQL.Visible.DesignOnly-->
                                <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="Visible">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.{System}.Visible.DesignOnly-->
                            <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[True]]></Value>
                            </VAR>
                        </DOM>
                    </VAR>
                    <DOM ShortName="edvAppli">
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.ApplicationId-->
                        <VAR ShortName="ApplicationId" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                            <Script><![CDATA[..edvAppli.ApplicationId + ".edvStats"]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data-->
                        <VAR ShortName="Data" ClassName="VarDataTable" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DataTable">
                            <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="XML"><xs:complexType><xs:sequence><xs:element name="IdParam" msdata:Caption="" type="xs:string" /><xs:element name="Value" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="Visual" msdata:Caption="" type="xs:boolean" minOccurs="0" /><xs:element name="Title" msdata:Caption="" type="xs:string" minOccurs="0" /><xs:element name="UserLevel" msdata:Caption="" type="xs:int" minOccurs="0" /><xs:element name="Category" msdata:Caption="" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="XML" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element ref="XML" /></xs:choice></xs:complexType><xs:unique name="Constraint1" msdata:PrimaryKey="true"><xs:selector xpath=".//XML" /><xs:field xpath="IdParam" /></xs:unique></xs:element></xs:schema></Schema><Data /></DataTable>]]></Value>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource-->
                        <VAR ShortName="DataSource" ClassName="VarDataSource" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Text">
                            <Script><![CDATA[..edvAppli.DataSource]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVClient-->
                        <VAR ShortName="EDVClient" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object" />
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual-->
                        <VAR ShortName="EDVVisual" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File">
                            <Script><![CDATA[.{Sys}.Path.Bin + "\\EDVVisual.exe"]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.OnLoad-->
                        <VAR ShortName="OnLoad" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                            <Script><![CDATA[when(..:Checking && ..)
{//edvAppli passe à true lors du chargement du fichier edvars du fait de l'existance d'un script OnLoad
	edvInfo = "Chargement de " + ..:Domain;
	Data.Open;
}
else if(edvSender.IsSys && .. && :Scripting){
	//Reset des objets edvStat, si === master
	..edvStat.ResetAll;
}
null;
]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save-->
                        <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="1" ValueType="Boolean" />
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Title-->
                        <VAR ShortName="Title" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                            <Script><![CDATA[..edvAppli.Title]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Url-->
                        <VAR ShortName="Url" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                            <Script><![CDATA[..:Domain + "edv"]]></Script>
                        </VAR>
                        <DOM ShortName="Data">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Open-->
                            <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Save-->
                            <VAR ShortName="Save" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Source-->
                            <VAR ShortName="Source" ClassName="VarDataSource" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Text">
                                <Script><![CDATA["Provider=XML;Data Source=" + :DBName;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Validate-->
                            <VAR ShortName="Validate" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <DOM ShortName="Open">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Open.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changing)
{
	edvInfo = :Name + " : Chargement des paramètres généraux.";
	var lVarRoot;
	if ((lVarRoot = ..edvAppli:Parent) != null)
		for(var lRow in ...:Rows)
		{
			var lVarName = lRow["IdParam"];
			var lVar = null;

			lVar = lVarRoot[lVarName];
			if (lVar != null)
				lVar.Value = lRow["Value"];
			else
				edvInfo = :Name + " : la donnée sauvegardée '" + lVarName + "' ne correspond à aucune variable.";
		}
}
null;]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Open.OnChecking-->
                                <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Checking)
	if(..Source.DBName == ""){
		.. = false;
	}
null;]]></Script>
                                </VAR>
                                <DOM ShortName="OnChanging">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Open.OnChanging._Script-->
                                    <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[when(..:Changing)
{
	edvInfo = :Name + " : Chargement des paramètres généraux.";
	var lVarRoot;
	if ((lVarRoot = ..edvAppli:Parent) != null)
		for(var lRow in ...:Rows)
		{
			var lVarName = lRow["IdParam"];
			var lVar = null;

			lVar = lVarRoot[lVarName];
			if (lVar != null)
				lVar.Value = lRow["Value"];
			else
				edvInfo = :Name + " : la donnée sauvegardée '" + lVarName + "' ne correspond à aucune variable.";
		}
}
null;]]></Value>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="Save">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Save.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..)
{
	edvInfo = :Name + " : Enregistrement des paramètres généraux";
	var lVarRoot;
	if ((lVarRoot = ..edvAppli:Parent) != null) {
		var lDataTable = ...;
		for(var lRow in lDataTable.Rows)
		{
			var lVar = lVarRoot[lRow["IdParam"]];
			if (lVar != null)
				lRow["Value"] = lVar.Value;
		}

		for(lVar in edvClient.GetVariables(..edvAppli:Domain).Values)
			if (EDV.SaveLocation.ContainsLocation(lVar.SaveLocation, EDV.SaveLocation.Application))
			{
				if (lDataTable.Select("IdParam = '" + lVar.Name + "'"
					+ " OR IdParam = '" + lVar.Name.Substring(lVarRoot.Name.Length+1) + "'").Length == 0)
					lDataTable.Rows.Add(lVar.Name.Substring(lVarRoot.Name.Length+1), lVar.Value);
			}

		//Tableau de noms de variables à ajouter en cas d'absence. Noms relatifs à lVarRoot==..edvAppli:Parent.
		var variables = [
				];
		//, ".{Sys}.Web.WebServer.CheckSecurity"

		for(var i : int = 0; i < variables.length; i++)
			if (lDataTable.Select("IdParam = '" + variables[i] + "'").Length==0)
				if ((lVar = lVarRoot[variables[i]]) != null)
					lDataTable.Rows.Add(variables[i] , lVar.Value);
				else 
					edvError = :Name + "\tLe paramètre " + variables[i] + " n'est pas une variable";

		..Validate;
	}
}
]]></Script>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Source">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Source.DBName-->
                                <VAR ShortName="DBName" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                                    <Script><![CDATA[var lsFile = ..Save.File;//Fichier .edvars d'où est chargé l'application
if (lsFile != "" && !lsFile.StartsWith("\t\t\tATTENTION")) Path.GetDirectoryName(lsFile) + "\\" + ..ApplicationId + ".Params.xml";
else "";
]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Source.DBPassword-->
                                <VAR ShortName="DBPassword" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Password" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Source.DBServer-->
                                <VAR ShortName="DBServer" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Source.DBType-->
                                <VAR ShortName="DBType" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[XML]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Data.Source.DBUser-->
                                <VAR ShortName="DBUser" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                            </DOM>
                        </DOM>
                        <DOM ShortName="DataSource">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource._Script-->
                            <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[..edvAppli.DataSource]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource.DBName-->
                            <VAR ShortName="DBName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[qv]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource.DBPassword-->
                            <VAR ShortName="DBPassword" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Password" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource.DBServer-->
                            <VAR ShortName="DBServer" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[test]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource.DBType-->
                            <VAR ShortName="DBType" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[MySQL]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.DataSource.DBUser-->
                            <VAR ShortName="DBUser" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[qv]]></Value>
                            </VAR>
                        </DOM>
                        <DOM ShortName="EDVVisual">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer-->
                            <VAR ShortName="_Designer" ClassName="VarVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Visual" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments-->
                            <VAR ShortName="Arguments" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?
if(:Address != "") 	echo("Address:=" + :Address + " ");
if(:Port != 0) 		echo("Port:=" + :Port + " ");
if(:Open.Always && :Open != "") 		echo("OpenIf:=Always ");
else						echo("OpenIf:=NotExists ");
if(:Open != "") 		echo("Open:=" + :Open + " ");
if(:OpenInSession >= 0) 	echo("OpenInSession:=" + :OpenInSession + " ");
if(:Close) 			echo("Close:=1" + " ");
if(:Url != "") 		echo("Url:=" + :Url + " ");
if(:Var != "") 		echo("Var:=" + :Var + " ");
if(:Visual != "") 	echo("Visual:=" + :Visual + " ");
?>]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.CreateDesktopShortCut-->
                            <VAR ShortName="CreateDesktopShortCut" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Open-->
                            <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <DOM ShortName="_Designer">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN-->
                                <VAR ShortName="WIN" ClassName="WinForm@EDVVisual" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.Height-->
                                    <VAR ShortName="Height" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[115]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.Text-->
                                    <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Name]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.TextAuto-->
                                    <VAR ShortName="TextAuto" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.Width-->
                                    <VAR ShortName="Width" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[303]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.WindowStartPosition-->
                                    <VAR ShortName="WindowStartPosition" ClassName="FormStartPosition@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[Manual]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.WindowState-->
                                    <VAR ShortName="WindowState" ClassName="FormWindowState@System.Windows.Forms" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                        <Value><![CDATA[Normal]]></Value>
                                    </VAR>
                                    <DOM ShortName="ctrlAlways">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlAlways.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[Arguments.Open.Always]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlAlways._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlVar]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlAlways.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=31,Y=44,Width=60,Height=16}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlCreateDesktopShortCut">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlCreateDesktopShortCut.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[CreateDesktopShortCut]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlCreateDesktopShortCut._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlVar]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlCreateDesktopShortCut.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=115,Y=70,Width=141,Height=16}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlEDVVisual">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlEDVVisual.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[..EDVVisual]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlEDVVisual._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlVar]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlEDVVisual.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=3,Y=2,Width=75,Height=16}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlOpen">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlOpen.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[Arguments.Open]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlOpen._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlVar]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlOpen.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=19,Y=24,Width=283,Height=16}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlOpen1">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlOpen1.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[Open]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlOpen1._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlVar]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlOpen1.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=15,Y=98,Width=49,Height=16}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlShortCutName">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[CreateDesktopShortCut.ShortCutName]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlText]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=189,Y=90,Width=100,Height=13}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlShortCutName1">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName1.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[CreateDesktopShortCut.ShortCutName]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName1._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlVar]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlShortCutName1.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=129,Y=90,Width=54,Height=14}]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="ctrlSub">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlSub.@-->
                                        <VAR ShortName="@" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                            <Value><![CDATA[Arguments.Visual.Sub]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlSub._ClassName-->
                                        <VAR ShortName="_ClassName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[EDVCtrlText]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual._Designer.WIN.ctrlSub.Bounds-->
                                        <VAR ShortName="Bounds" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Object">
                                            <Value><![CDATA[{X=17,Y=68,Width=50,Height=20}]]></Value>
                                        </VAR>
                                    </DOM>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Arguments">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Address-->
                                <VAR ShortName="Address" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Close-->
                                <VAR ShortName="Close" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Open-->
                                <VAR ShortName="Open" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File">
                                    <Script><![CDATA[..edvAppli.Save.File]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.OpenInSession-->
                                <VAR ShortName="OpenInSession" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[-1]]></Value>
                                    <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>HTML</DESIGNER.LASTPRESENTATION>]]></Meta>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Port-->
                                <VAR ShortName="Port" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Url-->
                                <VAR ShortName="Url" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Var-->
                                <VAR ShortName="Var" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Visual-->
                                <VAR ShortName="Visual" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="VariableName">
                                    <Script><![CDATA[..edvAppli:Domain + :Sub]]></Script>
                                </VAR>
                                <DOM ShortName="Open">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Open.Always-->
                                    <VAR ShortName="Always" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="Visual">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.Arguments.Visual.Sub-->
                                    <VAR ShortName="Sub" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="VariableName">
                                        <Value><![CDATA[Visual]]></Value>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="CreateDesktopShortCut">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.CreateDesktopShortCut.AllUsers-->
                                <VAR ShortName="AllUsers" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.CreateDesktopShortCut.OnChanging-->
                                <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changing)
{
	var exeFile = ...;
	var linkName : String = ShortCutName;

	var Shell = new ActiveXObject("WScript.Shell");
	var DesktopPath = Shell.SpecialFolders(AllUsers ? "AllUsersDesktop" : "Desktop");
	var link = Shell.CreateShortcut(DesktopPath + "\\"+  linkName + ".lnk");
	link.Arguments = edvcode(..Arguments:Name);
	link.Description = "";
	//link.HotKey = "CTRL+ALT+SHIFT+X";
	link.IconLocation = exeFile + ", 0";
	link.TargetPath = exeFile;
	link.WindowStyle = 1;
	link.WorkingDirectory = Path.GetDirectoryName(exeFile);
	link.Save();

}
null;]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.EDVVisual.CreateDesktopShortCut.ShortCutName-->
                                <VAR ShortName="ShortCutName" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="String">
                                    <Script><![CDATA[..edvAppli.Title]]></Script>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="Save">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.File-->
                            <VAR ShortName="File" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File" SaveLocation="V">
                                <Script><![CDATA[when(..edvAppli.Save.File.Exists)
	Path.GetDirectoryName(..edvAppli.Save.File) + "\\CoopEShop.Admin.edvStats.edvars";
else {
		edvInfo ="\t\t\tATTENTION : le fichier d'application n'est pas défini pour " + ..edvAppli:Domain;
}]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.Local-->
                            <VAR ShortName="Local" ClassName="VarFile" AutoReset="0" Securized="1" ReadOnly="1" ValueType="File" SaveLocation="V">
                                <Script><![CDATA[when(..edvAppli.Save.File.Exists)
	Path.GetDirectoryName(..edvAppli.Save.File) + "\\CoopEShop.edvStats.local.edvars";
else {
		edvInfo ="\t\t\tATTENTION : le fichier d'application n'est pas défini pour " + ..edvAppli:Domain;
}]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..)
{	..Data.Save;

	var root = edvTools.ParentName(..edvAppli:Name);

	var fileName : String;
	var variables : VariableList;

	fileName = File;
	//ED120813 : inclus dans Global
	//variables = edvars("^" + Regex.Escape(root) + "(?!\\.{LOCAL}\\.)", -1);
	//edvClient.SaveToVarsFile(fileName, VariableList(variables), new VariableListOptions(variables.Root));

	var varLocal;
	if((varLocal = edvSender[root + ".{Local}"]) != null){
		fileName = Local;
		variables = edvars(varLocal.Name, -1);
		edvClient.SaveToVarsFile(fileName, VariableList(variables), new VariableListOptions(variables.Root));
		edvInfo = root + ".{Local}" + " est enregistré dans " + fileName;
	}

}
null;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.OnChecking-->
                            <VAR ShortName="OnChecking" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Checking)
{
	if(!.EDV.CoopEShop.edvAppli.Save)
		.EDV.CoopEShop.edvAppli.Save;

	var varLog = edvar(..:Domain + "log");
	if(varLog != null) varLog.Value = :Name;

	if (File == "") {
		edvError = "Impossible d'enregistrer l'application car le fichier d'origine est inconnu";
		.. = false;
	}
}
null;]]></Script>
                            </VAR>
                            <DOM ShortName="File">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.File._Script-->
                                <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[when(..edvAppli.Save.File.Exists)
	Path.GetDirectoryName(..edvAppli.Save.File) + "\\CoopEShop.Admin.edvStats.edvars";
else {
		edvInfo ="\t\t\tATTENTION : le fichier d'application n'est pas défini pour " + ..edvAppli:Domain;
}]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.File.Exists-->
                                <VAR ShortName="Exists" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.File.Exists.OnChanging-->
                                    <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Null">
                                        <Script><![CDATA[when(..:Changing || :Scripting)
{
	..Save:ReadOnly = !(..);
}
null;]]></Script>
                                    </VAR>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Local">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvAppli.Save.Local.Exists-->
                                <VAR ShortName="Exists" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                    </DOM>
                    <DOM ShortName="edvExpander">
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander._Script-->
                        <VAR ShortName="_Script" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[.{Applications}.edvStats.edvExpander]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander._Where-->
                        <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                            <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander.Duplicate-->
                        <VAR ShortName="Duplicate" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                            <Script><![CDATA[.{Applications}.edvStats.edvExpander.Duplicate]]></Script>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander.Provider-->
                        <VAR ShortName="Provider" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                            <Script><![CDATA[.{Applications}.edvStats.edvExpander.Provider]]></Script>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION><SCRIPTER.SCRIPTTYPE>HTML</SCRIPTER.SCRIPTTYPE>]]></Meta>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander.ToolBar-->
                        <VAR ShortName="ToolBar" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                            <Script><![CDATA[.{Applications}.edvStats.edvExpander.ToolBar]]></Script>
                            <Meta><![CDATA[<SCRIPTER.SCRIPTTYPE>HTML</SCRIPTER.SCRIPTTYPE><DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <DOM ShortName="Duplicate">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander.Duplicate.Models-->
                            <VAR ShortName="Models" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                                <Script><![CDATA[.{Applications}.edvStats.edvExpander.Duplicate.Models]]></Script>
                            </VAR>
                        </DOM>
                        <DOM ShortName="Provider">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander.Provider._Where-->
                            <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                                <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                            </VAR>
                        </DOM>
                        <DOM ShortName="ToolBar">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvExpander.ToolBar._Where-->
                            <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                                <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="edvStat">
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged-->
                        <VAR ShortName="ChildSQLSelectChanged" ClassName="VarTrace" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer">
                            <Value><![CDATA[0]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ResetAll-->
                        <VAR ShortName="ResetAll" ClassName="" AutoReset="1" Securized="0" ReadOnly="0" ValueType="Boolean">
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                        </VAR>
                        <DOM ShortName="ChildSQLSelectChanged">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged._Description-->
                            <VAR ShortName="_Description" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<pre class="edvDescription">Surveille la modification d'une variable 
- SQLSelect pour reset de edvStat]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.Changes-->
                            <VAR ShortName="Changes" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?//Retourne les variables qui ont été modifiées depuis un moment de référence.
//Appel JS : EDVServer.VarTrace.Changes(.MyApp.MyTrace:Object,{Since:0,Clear:true});
//Appel Url : /edv/.{Library}.EDVServer.VarTrace.Changes.edvcode?edvsender=.MyApp.MyTrace&edvargs={Since:0,Clear:true}
//edvSender doit être une variable EDVServer.VarTrace

//Moment de référence
var since = arguments && arguments.Since ? arguments.Since : 0;
var VarClear; //sous-variable Clear
//Effacement de la liste après récupération
var clear = arguments && arguments.Clear ? arguments.Clear : false;
//Liste issue de la variable VarTrace
var traces;
if((traces = VarTrace(edvSender).List) != null) {
	var tracesIndex = [];//tableau des index
	var tracesNames = new ArrayList();
	for(var i : int = traces.Count-1; i>=0; i--) {//cherche le 1er 'avant'
		if(traces[i].Time <= since) break;
		if (!tracesNames.Contains(traces[i].Variable))//la trace peut avoir plusieurs fois la même variable
			tracesIndex.push(i);//mémorise l'index
	}
	var lnTrace : int = 0;
	for(i = tracesIndex.length-1; i >=0; i--){//dans l'ordre
		if(lnTrace++ > 0) echo(newline);
		echo(traces[tracesIndex[i]].Time + "\t" + traces[tracesIndex[i]].Variable);
	}
	if (lnTrace==0) echo(" ");//erreur ajax si retour vide
	if (clear) traces.Clear();
}?>]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.Enabled-->
                            <VAR ShortName="Enabled" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Boolean" SaveLocation="V">
                                <Script><![CDATA[when(..edvAppli:Changed) ..edvAppli]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.List-->
                            <VAR ShortName="List" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Object" SaveLocation="V" Control="EDVCtrlArray" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changing)
{  //traite la liste de variables modifiées et effacement de la liste
	var varList = List:Object;
	var edvStatVar : IVariable;
	if(varList.Value != null)
	for(var traceItem in varList.Value)
		if(traceItem.VariableObject != null
		&& (edvStatVar = traceItem.VariableObject.Parent["edvStat"]) != null){
			//edvInfo = traceItem.ToString();
			edvStatVar.Value = null;
		}
	varList.Value.Clear();
}
null;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.RegExp-->
                            <VAR ShortName="RegExp" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="String">
                                <Script><![CDATA[("^" + Regex.Escape(edvTools.Domain(edvTools.ParentName(..:NameUpper)))
+ ".+SQLSELECT$").ToUpperInvariant()
]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.Reset-->
                            <VAR ShortName="Reset" ClassName="" AutoReset="1" Securized="0" ReadOnly="1" ValueType="Boolean">
                                <Script><![CDATA[Enabled]]></Script>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>HTML</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.SuspendEvent-->
                            <VAR ShortName="SuspendEvent" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                <Value><![CDATA[False]]></Value>
                            </VAR>
                            <DOM ShortName="ListenFor">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.ListenFor.Changed-->
                                <VAR ShortName="Changed" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.ListenFor.Changing-->
                                <VAR ShortName="Changing" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.ListenFor.Checking-->
                                <VAR ShortName="Checking" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[True]]></Value>
                                </VAR>
                            </DOM>
                            <DOM ShortName="RegExp">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.RegExp.OptionsCompiled-->
                                <VAR ShortName="OptionsCompiled" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Boolean">
                                    <Value><![CDATA[False]]></Value>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Reset">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ChildSQLSelectChanged.Reset.OnChanged-->
                                <VAR ShortName="OnChanged" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Null">
                                    <Script><![CDATA[when(..:Changed)
{
	..RegExp = ..RegExp;
}
null;]]></Script>
                                </VAR>
                            </DOM>
                        </DOM>
                        <DOM ShortName="ResetAll">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.edvStat.ResetAll.OnChanging-->
                            <VAR ShortName="OnChanging" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Null">
                                <Script><![CDATA[when(..:Changing)
{
	edvars("^" + Regex.Escape(..edvStats:Name) + "\\..*\\.edvStat$")
		.Each(function(){
			if(this.ValueType == EDVType.Object)
				//edvServer.Info = this.Name;
				this.Value = null;
		});
}
null;]]></Script>
                            </VAR>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Fournisseur">
                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues-->
                        <VAR ShortName="Catalogues" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Domain" />
                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.edvDocument-->
                        <VAR ShortName="edvDocument" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<?=edv.HTML.edvStat(arguments, edvSender["List"], edvClient)?>
]]></Value>
                        </VAR>
                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List-->
                        <VAR ShortName="List" ClassName="VarDataTable" AutoReset="0" Securized="0" ReadOnly="0" ValueType="DataTable">
                            <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="MySQL" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element name="MySQL"><xs:complexType><xs:sequence><xs:element name="Name" type="xs:string" minOccurs="0" /><xs:element name="nbCtlogs" type="xs:int" minOccurs="0" /><xs:element name="NbCmdes" type="xs:int" minOccurs="0" /><xs:element name="LastCmde" type="xs:dateTime" minOccurs="0" /><xs:element name="ZipCode" type="xs:string" minOccurs="0" /><xs:element name="Message" type="xs:string" minOccurs="0" /><xs:element name="IdFournisseur" type="xs:int" minOccurs="0" /><xs:element name="IdContact" type="xs:int" minOccurs="0" /><xs:element name="EMail" type="xs:string" minOccurs="0" /><xs:element name="City" type="xs:string" minOccurs="0" /><xs:element name="Enabled" type="xs:int" minOccurs="0" /><xs:element name="contactName" type="xs:string" minOccurs="0" /></xs:sequence></xs:complexType></xs:element></xs:choice></xs:complexType></xs:element></xs:schema></Schema><Data /></DataTable>]]></Value>
                            <Meta><![CDATA[<HTMLEDITOR />]]></Meta>
                        </VAR>
                        <DOM ShortName="Catalogues">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List-->
                            <VAR ShortName="List" ClassName="VarDataTable" AutoReset="0" Securized="0" ReadOnly="0" ValueType="DataTable">
                                <Value><![CDATA[<?xml version="1.0" encoding="utf-16"?><DataTable><Schema><xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"><xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:MainDataTable="MySQL" msdata:UseCurrentLocale="true"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element name="MySQL"><xs:complexType><xs:sequence><xs:element name="IdContact" type="xs:int" minOccurs="0" /><xs:element name="IdDossier" type="xs:int" minOccurs="0" /><xs:element name="TypeDossier" type="xs:string" minOccurs="0" /><xs:element name="DateDossier" type="xs:dateTime" minOccurs="0" /><xs:element name="Name" type="xs:string" minOccurs="0" /><xs:element name="IdClient" type="xs:int" minOccurs="0" /><xs:element name="ClosedDate" type="xs:dateTime" minOccurs="0" /><xs:element name="Status" type="xs:string" minOccurs="0" /><xs:element name="Visibility" type="xs:string" minOccurs="0" /><xs:element name="IdDossierRef" type="xs:int" minOccurs="0" /><xs:element name="TypeDossierRef" type="xs:string" minOccurs="0" /><xs:element name="Comment" type="xs:string" minOccurs="0" /><xs:element name="IdUser" type="xs:int" minOccurs="0" /><xs:element name="UpdateDate" type="xs:dateTime" minOccurs="0" /></xs:sequence></xs:complexType></xs:element></xs:choice></xs:complexType></xs:element></xs:schema></Schema><Data /></DataTable>]]></Value>
                                <Meta><![CDATA[<HTMLEDITOR />]]></Meta>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Close-->
                                <VAR ShortName="Close" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.edvDocument-->
                                <VAR ShortName="edvDocument" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<?=edv.HTML.edvStat(arguments, edvSender, edvClient)?>]]></Value>
                                    <Meta><![CDATA[<HTMLEDITOR />]]></Meta>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.edvStat-->
                                <VAR ShortName="edvStat" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Object" SaveLocation="V">
                                    <Script><![CDATA[me = null]]></Script>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Error-->
                                <VAR ShortName="Error" ClassName="VarLog" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" SaveLocation="V" Control="EDVCtrlLog" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Icon-->
                                <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[imgEDVTypeDataTable]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Open-->
                                <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="0" ReadOnly="0" ValueType="Boolean" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row-->
                                <VAR ShortName="Row" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                                    <Value><![CDATA[-1]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.RowsCount-->
                                <VAR ShortName="RowsCount" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.SQLSelect-->
                                <VAR ShortName="SQLSelect" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[SELECT *
FROM dossier d
WHERE d.TypeDossier = 'CTLOG'
AND d.IdContact = :IDCONTACT]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Status-->
                                <VAR ShortName="Status" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer" SaveLocation="V" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Text-->
                                <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[Liste]]></Value>
                                </VAR>
                                <DOM ShortName="Open">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Open._Index-->
                                    <VAR ShortName="_Index" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[0]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Open.Icon-->
                                    <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[imgEDVTypeBoolean]]></Value>
                                    </VAR>
                                    <DOM ShortName="Visible">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Open.Visible.DesignOnly-->
                                        <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="Row">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.ClosedDate-->
                                    <VAR ShortName="ClosedDate" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DateTime">
                                        <Value><![CDATA[01/01/0001 00:00:00]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Comment-->
                                    <VAR ShortName="Comment" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.DateDossier-->
                                    <VAR ShortName="DateDossier" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DateTime">
                                        <Value><![CDATA[01/01/0001 00:00:00]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdClient-->
                                    <VAR ShortName="IdClient" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[0]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdContact-->
                                    <VAR ShortName="IdContact" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[0]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossier-->
                                    <VAR ShortName="IdDossier" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[0]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossierRef-->
                                    <VAR ShortName="IdDossierRef" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[0]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdUser-->
                                    <VAR ShortName="IdUser" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[0]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Name-->
                                    <VAR ShortName="Name" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Status-->
                                    <VAR ShortName="Status" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossier-->
                                    <VAR ShortName="TypeDossier" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossierRef-->
                                    <VAR ShortName="TypeDossierRef" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.UpdateDate-->
                                    <VAR ShortName="UpdateDate" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DateTime">
                                        <Value><![CDATA[01/01/0001 00:00:00]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Visibility-->
                                    <VAR ShortName="Visibility" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <DOM ShortName="_table">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row._table.cssBody-->
                                        <VAR ShortName="cssBody" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[background-color: white;
}
> tr.expanded > td {
background-color: #F0F0F0;
padding-top: 6px;
padding-bottom: 4px;
}
> tr:hover > td {
background-color: #E0E7F0;
}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row._table.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row._table.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row._table.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                        <DOM ShortName="Foot">
                                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row._table.Foot.Visible-->
                                            <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                                <Value><![CDATA[False]]></Value>
                                            </VAR>
                                        </DOM>
                                        <DOM ShortName="Head">
                                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row._table.Head.Visible-->
                                            <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                                <Value><![CDATA[False]]></Value>
                                            </VAR>
                                        </DOM>
                                    </DOM>
                                    <DOM ShortName="ClosedDate">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.ClosedDate.Cell-->
                                        <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[<?=this.IsNull() || this.Value().Year == 1 ? "" : edvTools.EscapeHtml(this.Value().ToString()) ?>]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.ClosedDate.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.ClosedDate.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.ClosedDate.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Fermeture]]></Value>
                                        </VAR>
                                        <DOM ShortName="Cell">
                                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.ClosedDate.Cell.Default-->
                                            <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                                <Value><![CDATA[False]]></Value>
                                            </VAR>
                                        </DOM>
                                    </DOM>
                                    <DOM ShortName="Comment">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Comment.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Comment.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Comment.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Commentaire]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="DateDossier">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.DateDossier.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.DateDossier.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.DateDossier.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Date]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="IdClient">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdClient.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdClient.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdClient.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="IdContact">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdContact.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdContact.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdContact.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="IdDossier">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossier.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossier.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossier.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[#]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="IdDossierRef">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossierRef.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossierRef.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdDossierRef.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="IdUser">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdUser.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdUser.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.IdUser.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Name">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Name.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Name.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Name.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Nom]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Status">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Status.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Status.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Status.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Etat]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="TypeDossier">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossier.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossier.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossier.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="TypeDossierRef">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossierRef.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossierRef.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.TypeDossierRef.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="UpdateDate">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.UpdateDate.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.UpdateDate.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.UpdateDate.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Visibility">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Visibility.Filter-->
                                        <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Visibility.Foot-->
                                        <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Row.Visibility.Head-->
                                        <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[Visibilité]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="RowsCount">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.RowsCount.Limit-->
                                    <VAR ShortName="Limit" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[30]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="SQLSelect">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.SQLSelect.IDCONTACT-->
                                    <VAR ShortName="IDCONTACT" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                        <Value><![CDATA[43]]></Value>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.SQLSelect.IDCONTACT.DesignOnly-->
                                        <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.SQLSelect.IDCONTACT.Text-->
                                        <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                            <Value><![CDATA[IDCONTACT]]></Value>
                                        </VAR>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="Visible">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.Catalogues.List.Visible.DesignOnly-->
                                    <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                            </VAR>
                        </DOM>
                        <DOM ShortName="edvDocument">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.edvDocument._Where-->
                            <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function" SaveLocation="V">
                                <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                            </VAR>
                        </DOM>
                        <DOM ShortName="List">
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Close-->
                            <VAR ShortName="Close" ClassName="" AutoReset="1" Securized="1" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.edvDocument-->
                            <VAR ShortName="edvDocument" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?=edv.HTML.edvStat(arguments, edvSender, edvClient)?>]]></Value>
                                <Meta><![CDATA[<HTMLEDITOR />]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.edvStat-->
                            <VAR ShortName="edvStat" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Object" SaveLocation="V">
                                <Script><![CDATA[me = null]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Error-->
                            <VAR ShortName="Error" ClassName="VarLog" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String" SaveLocation="V" Control="EDVCtrlLog" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Open-->
                            <VAR ShortName="Open" ClassName="" AutoReset="1" Securized="0" ReadOnly="0" ValueType="Boolean" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row-->
                            <VAR ShortName="Row" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Domain">
                                <Value><![CDATA[-1]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.RowsCount-->
                            <VAR ShortName="RowsCount" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer">
                                <Value><![CDATA[0]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.SQLSelect-->
                            <VAR ShortName="SQLSelect" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[SELECT f.Name
, nbCtlogs
, NbCmdes
, LastCmde
, c.ZipCode
, f.Message
, f.IdFournisseur, f.IdContact, c.EMail, c.City
, IF(f.Enabled = 1 AND c.Enabled = 1, 1, 0) AS Enabled
, c.Name AS contactName
FROM fournisseur f
INNER JOIN contact c
	ON c.IdContact = f.IdContact
LEFT JOIN (	SELECT IdContact, COUNT(IdDossier) AS nbCtlogs
		FROM dossier 
		WHERE TypeDossier = 'CTLOG'
		GROUP BY IdContact) ctlog
	ON ctlog.IdContact = c.IdContact
LEFT JOIN (	SELECT IdContact, COUNT(IdDossier) AS NbCmdes, MAX(DateDossier) AS LastCmde
		FROM dossier 
		WHERE TypeDossier = 'CMD'
		AND TypeDossierRef = 'CTLOG'
		GROUP BY IdContact) cmd
	ON cmd.IdContact = c.IdContact
	
ORDER BY c.Name]]></Value>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Status-->
                            <VAR ShortName="Status" ClassName="" AutoReset="0" Securized="0" ReadOnly="1" ValueType="Integer" SaveLocation="V" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Text-->
                            <VAR ShortName="Text" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="String">
                                <Value><![CDATA[Liste]]></Value>
                            </VAR>
                            <DOM ShortName="Open">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Open._Index-->
                                <VAR ShortName="_Index" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Open.Icon-->
                                <VAR ShortName="Icon" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                    <Value><![CDATA[imgEDVTypeBoolean]]></Value>
                                </VAR>
                                <DOM ShortName="Visible">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Open.Visible.DesignOnly-->
                                    <VAR ShortName="DesignOnly" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                            </DOM>
                            <DOM ShortName="Row">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.City-->
                                <VAR ShortName="City" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.contactName-->
                                <VAR ShortName="contactName" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.EMail-->
                                <VAR ShortName="EMail" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled-->
                                <VAR ShortName="Enabled" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdContact-->
                                <VAR ShortName="IdContact" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur-->
                                <VAR ShortName="IdFournisseur" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.LastCmde-->
                                <VAR ShortName="LastCmde" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="DateTime">
                                    <Value><![CDATA[01/01/0001 00:00:00]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Message-->
                                <VAR ShortName="Message" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name-->
                                <VAR ShortName="Name" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes-->
                                <VAR ShortName="NbCmdes" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs-->
                                <VAR ShortName="nbCtlogs" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[0]]></Value>
                                </VAR>
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode-->
                                <VAR ShortName="ZipCode" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                <DOM ShortName="_table">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.className-->
                                    <VAR ShortName="className" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[edvEditor]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.cssBody-->
                                    <VAR ShortName="cssBody" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[background-color: white;
}
> tr.expanded > td {
background-color: #F0F0F0;
padding-top: 6px;
padding-bottom: 4px;
}

> * .edvExpander.expanded {
font-weight: bold;

> tr:hover > td {
background-color: #E0E7F0;
}]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <DOM ShortName="Foot">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.Foot.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                    <DOM ShortName="Head">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row._table.Head.Visible-->
                                        <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="City">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.City.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.City.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.City.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.City.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="contactName">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.contactName.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.contactName.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.contactName.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="EMail">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.EMail.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.EMail.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.EMail.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.EMail.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.EMail.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[font-size: smaller;]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="Enabled">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[ ]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Enabled.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[True]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="IdContact">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdContact.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdContact.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdContact.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                </DOM>
                                <DOM ShortName="IdFournisseur">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[#]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Visible-->
                                    <VAR ShortName="Visible" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                        <Value><![CDATA[False]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.IdFournisseur.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[True]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="LastCmde">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.LastCmde.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.LastCmde.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.LastCmde.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Dernière]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.LastCmde.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[font-size: smaller;]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="Message">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Message.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Message.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Message.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[font-size: smaller;]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="Name">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<span class="edvExpander"
	name="edvCode=.EDV.CoopEShop.DB.Fournisseur.Html.Edit<?
		?>&edvArgs.Id=<?=this.Value("IdFournisseur")?>"
	title="fournisseur : <?=this.Value("IdFournisseur")?>, contact : <?=this.Value("IdContact")?>">
<span class="edvicon imgEDVTypeUser"><?=edvTools.EscapeHtml(this.Value())?><?
if(this.Value() != this.Value("contactName")) {
?> / <?=edvTools.EscapeHtml(this.Value("contactName"))?><?
}?><?if(this.Value("Enabled") == 0){
?><span class="edvicon imgEDVTypeFalse">&nbsp;</span><?
}?>
</span></span>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Nom]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[white-space:nowrap;
}
> * .imgEDVTypeFalse {
padding-left : 1em;
}]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.Name.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="NbCmdes">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<span class="edvExpander" name="edvcode=.{Html}.edvStat&edvSender=<?=edvSender.Domain?>Catalogues.List&edvArgs.SQLSelect.IdContact=<?=this.Value("IdContact")?>">
<span class="edvicon imgEDVTypeNum"><?=edvTools.EscapeHtml(this.IsNull() ? "0" : this.Value().ToString())?></span></span>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Commandes]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[text-align: right;
padding-right:0.5em;
}
> .edvicon {
padding-left:1.5em;]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.NbCmdes.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="nbCtlogs">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<span class="edvExpander" name="edvcode=.{Html}.edvStat&edvSender=<?=edvSender.Domain?>Catalogues.List&edvArgs.SQLSelect.IdContact=<?=this.Value("IdContact")?>">
<span class="edvicon imgEDVTypeNum"><?=edvTools.EscapeHtml(this.IsNull() ? "0" : this.Value().ToString())?></span></span>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Catalogues]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[padding-left:0.5em;
}
> .edvicon {
padding-left:1.5em;]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.nbCtlogs.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                                <DOM ShortName="ZipCode">
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode.Cell-->
                                    <VAR ShortName="Cell" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                        <Value><![CDATA[<?=this.IsNull() ? "" : edvTools.EscapeHtml(this.Value()) ?> <?=this.IsNull("City") ? "" : edvTools.EscapeHtml(this.Value("City")) ?>]]></Value>
                                    </VAR>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode.Filter-->
                                    <VAR ShortName="Filter" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode.Foot-->
                                    <VAR ShortName="Foot" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code" />
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode.Head-->
                                    <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="String">
                                        <Value><![CDATA[Adresse]]></Value>
                                    </VAR>
                                    <DOM ShortName="Cell">
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode.Cell.css-->
                                        <VAR ShortName="css" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                            <Value><![CDATA[font-size: smaller;]]></Value>
                                        </VAR>
                                        <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.Row.ZipCode.Cell.Default-->
                                        <VAR ShortName="Default" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Boolean">
                                            <Value><![CDATA[False]]></Value>
                                        </VAR>
                                    </DOM>
                                </DOM>
                            </DOM>
                            <DOM ShortName="RowsCount">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Fournisseur.List.RowsCount.Limit-->
                                <VAR ShortName="Limit" ClassName="" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Integer">
                                    <Value><![CDATA[30]]></Value>
                                </VAR>
                            </DOM>
                        </DOM>
                    </DOM>
                    <DOM ShortName="Visual">
                        <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML-->
                        <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                            <Value><![CDATA[<?edvClient.Activate();
//if(session.User && !session.User.Rights && edvClient.Rights[".Admin"].All)
//	session.User.Rights = {"Admin" : true};
/*for(var r in edvClient.Rights)
	edvInfo = r.ToString();*/
?><?=.{Applications}.edvStats.Visual.HTML(edvjs.Extend(arguments, {miniJS : false, "saveVariable" : ..Admin.edvAppli.Save:Name, toolBar : true }), edvSender, edvClient)?>]]></Value>
                            <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML._Where-->
                            <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                                <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.CSS-->
                            <VAR ShortName="CSS" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?arguments = edvjs.Extend({"miniJS" : false, "designMode" : true}, arguments);
?><?=.{Applications}.edvStats.Visual.HTML.CSS(arguments, edvSender, edvClient)?>
<?=.EDV.CoopEShop.Visual.HTML.CSS(arguments, edvClient)?>
<style>
#MainInner { margin-left: 4em; height: 85%; }
#MainHeader { display: block; }
</style>
]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.Head-->
                            <VAR ShortName="Head" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                <Value><![CDATA[<?arguments = edvjs.Extend({"miniJS" : false, "designMode" : true}, arguments);
?><?//=.{Applications}.edvStats.Visual.HTML.Head(arguments, edvSender, edvClient)?>
<?=.EDV.CoopEShop.Visual.HTML.HEAD(arguments, edvClient)?>
]]></Value>
                                <Meta><![CDATA[<DESIGNER.LASTPRESENTATION>Window</DESIGNER.LASTPRESENTATION><SCRIPTER.SCRIPTTYPE>HTML</SCRIPTER.SCRIPTTYPE>]]></Meta>
                            </VAR>
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.Main-->
                            <VAR ShortName="Main" ClassName="VarVisual" AutoReset="0" Securized="0" ReadOnly="0" ValueType="Visual" />
                            <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.Menu-->
                            <VAR ShortName="Menu" ClassName="" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Code">
                                <Script><![CDATA[.{Applications}.edvStats.Visual.HTML.Menu]]></Script>
                                <Meta><![CDATA[<SCRIPTER.SCRIPTTYPE>HTML</SCRIPTER.SCRIPTTYPE>]]></Meta>
                            </VAR>
                            <DOM ShortName="CSS">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.CSS._Where-->
                                <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                                    <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Head">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.Head._Where-->
                                <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                                    <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                                </VAR>
                            </DOM>
                            <DOM ShortName="Main">
                                <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.Main.HTML-->
                                <VAR ShortName="HTML" ClassName="" AutoReset="0" Securized="1" ReadOnly="0" ValueType="Code">
                                    <Value><![CDATA[<?=edv.{WEB}.Main(edvjs.Extend(arguments, {"noEDVFoot": true}), edvSender, edvClient)?><?/*remplacez par 'edv.{WEB}.Main.Value', surlignez tout puis F9 pour avoir le script*/?>
]]></Value>
                                    <!--.{Applications}.CoopEShop.Admin.edvStats.Visual.HTML.Main.HTML._Where-->
                                    <VAR ShortName="_Where" ClassName="VarFunction" AutoReset="0" Securized="1" ReadOnly="1" ValueType="Function">
                                        <Script><![CDATA[when(..:Changing) me = null;]]></Script>
                                    </VAR>
                                </VAR>
                            </DOM>
                        </VAR>
                    </DOM>
                </DOM>
            </VAR>
        </DOM>
    </DOM>
</EDV>